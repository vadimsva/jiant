(function(){var Ga=function(){return{template:function(f,z,t){return $("#"+f+z)},viewComponent:function(f,z,t,T,E){return f.find("."+t+T)},view:function(f,z){return $("#"+f+z)}}},S=function(f){function z(a){var b=Number(a);return 0===b&&0!==a&&"0"!==a||isNaN(b)?null:new Date(b)}function t(a){a=""+a;return 0==a.length?"00":1==a.length?"0"+a:a}function T(a){f.each(a.find("*"),function(a,c){f.each(c.attributes,function(a,b){0>b.value.indexOf(" ")&&0<=b.value.indexOf("!!")&&f(c).attr(b.name,b.value.replace(/!!/g,
"e2013e03e11eee "))})});return f.trim(f(a).html()).replace(/!!/g,"!! ").replace(/e2013e03e11eee /g,"!! ")}function E(a,b,c){A("Called parse template "+(c?c:"")+" with data",b);b=b||{};c=f.trim(f(a).html());var d={},e="";c=jiant.isMSIE?T(f(a)):c.replace(/!!/g,"!! ");try{var g=d[c];if(!g){var h="var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+c.replace(/[\r\t\n]/g," ").replace(/'(?=[^#]*#>)/g,"\t").split("'").join("\\'").split("\t").join("'").replace(/!! (.+?)!! /g,"',$1,'").split("!?").join("');").split("?!").join("p.push('")+
"');}return p.join('');",g=new Function("obj",h);d[c]=g}return f.trim(g(b))}catch(k){e=k.message,F("Error parse template: "+e)}return"!!! ERROR: "+e.toString()+" !!!"}function v(a,b,c){a=isNaN(b)?a:parseFloat(a)<b?b:a;a=isNaN(c)?a:parseFloat(a)>c?c:a;return""+a}function S(a){a.keydown(function(b){if(b.keyCode==jiant.key.down&&0<a.val())return a.val(v(a.valInt()-1,a.j_valMin,a.j_valMax)),a.trigger("change"),!1;if(b.keyCode==jiant.key.up)return a.val(v(a.valInt()+1,a.j_valMin,a.j_valMax)),a.trigger("change"),
!1;if(b.keyCode!=jiant.key.backspace&&b.keyCode!=jiant.key.del&&b.keyCode!=jiant.key.end&&b.keyCode!=jiant.key.left&&b.keyCode!=jiant.key.right&&b.keyCode!=jiant.key.home&&b.keyCode!=jiant.key.tab&&b.keyCode!=jiant.key.enter&&(b.shiftKey||(48>b.keyCode||57<b.keyCode)&&(96>b.keyCode||105<b.keyCode)))return b.preventDefault(),!1;a.val(v(a.valInt(),a.j_valMin,a.j_valMax));return!0});a.change(function(b){a.val(v(a.valInt(),a.j_valMin,a.j_valMax));return!1});a.valInt=function(){var b=parseInt(a.val());
return isNaN(b)?0:b};a.setMax=function(b){a.j_valMax=b;a.attr("max",b);a.val(v(a.valInt(),a.j_valMin,a.j_valMax))};a.setMin=function(b){a.j_valMin=b;a.attr("min",b);a.val(v(a.valInt(),a.j_valMin,a.j_valMax))}}function Ha(a){a.keydown(function(b){if(b.keyCode==jiant.key.down&&0<a.val())return a.val(v(a.valFloat()-1,a.j_valMin,a.j_valMax)),a.trigger("change"),!1;if(b.keyCode==jiant.key.up)return a.val(v(a.valFloat()+1,a.j_valMin,a.j_valMax)),a.trigger("change"),!1;if(b.keyCode==jiant.key.dot||b.keyCode==
jiant.key.dotExtra)return 0>a.val().indexOf(".")&&0<a.val().length;if(b.keyCode==jiant.key.backspace||b.keyCode==jiant.key.del||b.keyCode==jiant.key.end||b.keyCode==jiant.key.left||b.keyCode==jiant.key.right||b.keyCode==jiant.key.home||b.keyCode==jiant.key.tab||b.keyCode==jiant.key.enter)a.val(v(a.valFloat(),a.j_valMin,a.j_valMax));else{if(b.shiftKey||(48>b.keyCode||57<b.keyCode)&&(96>b.keyCode||105<b.keyCode))return b.preventDefault(),!1;a.val(v(a.val(),a.j_valMin,a.j_valMax))}return!0});a.valFloat=
function(){var b=parseFloat(a.val());return isNaN(b)?0:b};a.setMax=function(b){a.j_valMax=b;a.attr("max",b);a.val(v(a.valFloat(),a.j_valMin,a.j_valMax))};a.setMin=function(b){a.j_valMin=b;a.attr("min",b);a.val(v(a.valFloat(),a.j_valMin,a.j_valMax))}}function Ia(a,b,c,d){if(b[0]){var e=b[0].tagName.toLowerCase();"form"!=e&&(jiant.logError(c+"."+d+" form element assigned to non-form: "+e),jiant.DEV_MODE&&alert(c+"."+d+" form element assigned to non-form: "+e));b.submitForm=function(c,e){c=c?c:b.attr("action");
c=(a.ajaxPrefix?a.ajaxPrefix:jiant.AJAX_PREFIX?jiant.AJAX_PREFIX:"")+c;c+=a.ajaxSuffix?a.ajaxSuffix:jiant.AJAX_SUFFIX?jiant.AJAX_SUFFIX:"";var d={type:"POST",url:c,data:b.serialize(),success:e};a.crossDomain&&(d.contentType="application/json",d.dataType="jsonp",d.xhrFields={withCredentials:!0},d.crossDomain=!0);A("Submitting form",d);return f.ajax(d)}}}function ha(a,b){var c=b[0]+"";f.each(b,function(a,b){if(0<a){var g=c.indexOf("!!");0<=g?c=c.substring(0,g)+b+c.substring(g+2):(c+=" ",c+=b)}});a(c)}
function ia(a,b){var c="";f.each(b,function(a,b){c+=b;c+=" "});a(c)}function ja(a,b){window.console&&window.console[a]&&f.each(b,function(b,d){window.console[a](d)})}function F(){ja("error",arguments)}function B(a){jiant.DEV_MODE&&ja("info",arguments)}function U(){ia(F,arguments)}function M(){ia(B,arguments)}function A(a,b){jiant.DEBUG_MODE.data&&r("   ---   "+a)&&r(b)}function N(a){jiant.DEBUG_MODE.states&&r("   ---   "+a)}function w(a){jiant.DEBUG_MODE.events&&r("   ---   "+a)}function r(a){return window.console&&
window.console.error?(window.console.error(a),!0):!1}function Ja(a){function b(a,b){var h=f(E(f("<b><li class='!!ctlClass!!' style='cursor: pointer;'><a>!!label!!</a></li></b>"),{label:-1!=a?a:"...",ctlClass:b}));d.append(h);-1!=a&&h.click(function(){c.trigger("ValueChange",a)});return h}var c=f({}),d=f("<ul></ul>");d.addClass("pagination");a.append(d);a.onValueChange=function(a){c.on("ValueChange",a)};a.updatePager=function(a){A("Updating pager",a);d.empty();var c=Math.max(0,a.number-jiant.PAGER_RADIUS/
2),f=Math.min(a.number+jiant.PAGER_RADIUS/2,a.totalPages);0<c&&(b(1,""),b(-1,"disabled emptyPlaceholder"));for(;c<f;c++){var k="";c==a.number&&(k+=" active");b(c+1,k)}f<a.totalPages-1&&(b(-1,"disabled emptyPlaceholder"),b(a.totalPages,""))}}function Ka(a){function b(){h=Math.max(h,0);h=Math.min(h,e.children().length-1);c.css("visibility",0<h?"visible":"hidden");d.css("visibility",h<e.children().length-g?"visible":"hidden");f.each(e.children(),function(a,b){var c=f(b);a>=h&&a<h+g?c.show():c.hide()})}
var c=f("<div>&laquo;</div>"),d=f("<div>&raquo;</div>"),e=f("<div></div>"),g=8,h=0;c.addClass("paged-prev");d.addClass("paged-next");e.addClass("paged-container");a.empty();a.append(c);a.append(e);a.append(d);c.click(function(){h-=g;b()});d.click(function(){h+=g;b()});a.append=function(a){e.append(a);b()};a.empty=function(){e.empty();b()};a.setHorizontal=function(a){a=a?"inline-block":"block";c.css("display",a);d.css("display",a);e.css("display",a)};a.setPageSize=function(a){g=a;b()};a.setHorizontal(!0)}
function G(){var a={stack:{}};Error.captureStackTrace&&Error.captureStackTrace(a,G);return a.stack}function La(a,b,c,d,e,g){var h={};f.each(d,function(d,f){h[d]=d;if("appPrefix"!=d)if(b[d]===jiant.lookup)jiant.logInfo("    loookup element, no checks/bindings: "+d),b[d]=function(){return e.find("."+g+d)};else if(b[d]!==jiant.meta)if(b[d]===jiant.cssMarker)b[d].customRenderer=function(a,b,c,e,g){a=d+"_"+c;g.j_prevMarkerClass&&g.removeClass(g.j_prevMarkerClass);g.j_prevMarkerClass=a;g.addClass(a)};else{var l=
b[d]===V,x=W.viewComponent(e,c,g,d,f);O(g,a.dirtyList,x,g+c,g+d);b[d]=x;l&&la(a,b[d]);ma(a,x,f,c,d)}});b._jiantSpec=h}function Ma(a,b){f.each(a,function(a,d){b[a]&&(jiant.logError("unsafe extension: "+a+" already defined in base jQuery, shouldn't be used, now overriding!"),b[a]=void 0)})}function na(a){var b=typeof a;if("object"!=b||null===a)return"string"==b&&(a='"'+a+'"'),String(a);var c=[],d=a&&a.constructor==Array;f.each(a,function(a,g){b=typeof g;"string"==b?g='"'+g+'"':"object"==b&&null!==g&&
(g=na(g));c.push((d?"":'"'+a+'":')+(g?g:'""'))});return(d?"[":"{")+String(c)+(d?"]":"}")}function X(a,b,c){jiant.DEV_MODE&&a.click(function(d){if(d.shiftKey&&d.altKey){var e=b+(c?"."+c:"");d.ctrlKey&&(e=e+"\r\n------------\r\n"+na(f._data(a[0],"events")));jiant.logInfo(e);alert(e);d.preventDefault();d.stopImmediatePropagation()}})}function O(a,b,c,d,e){return d&&b&&(0<=f.inArray(d,b)||a&&0<=f.inArray(d.substring(a.length),b))?!0:c&&c.length?!0:(window.console&&window.console.error&&(e?jiant.logError("non existing object referred by class under object id '"+
d+"', check stack trace for details, expected obj class: "+e):jiant.logError("non existing object referred by id, check stack trace for details, expected obj id: "+d)),L=e?L+("   ,    #"+d+" ."+e):L+(", #"+d),Y=!1)}function ma(a,b,c,d,e){(c==jiant.tabs||c.tabsTmInner)&&b.tabs?(b.tabs(),b.refreshTabs=function(){b.tabs("refresh")}):c==jiant.inputInt||c.inputIntTmInner?S(b):c==jiant.inputFloat||c.inputFloatTmInner?Ha(b):(c==jiant.inputDate||c.inputDateTmInner)&&b.datepicker?b.datepicker():c==jiant.pager||
c.pagerTmInner?Ja(b):c==jiant.form||c.formTmInner?Ia(a,b,d,e):(c==oa||c.containerPagedTmInner)&&Ka(b);X(b,d,e)}function pa(a,b,c,d){var e={};f.each(b,function(a,b){e[a]=b});var g=function(h,k){A("Propagating "+a+" with data",h);k=void 0==k?!0:k;f.each(e,function(a,e){if(b[a].customRenderer||h&&void 0!=h[a]&&null!=h[a]&&!(0<=f.inArray(a,["parseTemplate","parseTemplate2Text","propagate"]))){var x=h[a];e=c[a];if(f.isFunction(x)){if(Z(b,a)(h,e,x(),!1,d),k&&f.isFunction(x.on)){if(g[a]){var H=g[a][0];H&&
H(g[a][1])}H=x.on(function(c,g){Z(b,a)(h,e,g,!0,d)});g[a]=[x.off,H]}}else Z(b,a)(h,e,x,!1,d)}})};return g}function Z(a,b){return a[b]&&a[b].customRenderer&&f.isFunction(a[b].customRenderer)?a[b].customRenderer:Na}function Na(a,b,c,d,e){b&&b[0]&&(a=["text","hidden",void 0],d=b[0].tagName.toLowerCase(),"input"==d||"textarea"==d||"select"==d?(d=f(b[0]).attr("type"),0<=f.inArray(d,a)?b.val(c):"checkbox"==d?b.prop("checked",c?!0:!1):"radio"==d&&f.each(b,function(a,b){f(b).prop("checked",b.value==c)})):
"img"==d?b.attr("src",c):b.html(c))}function Oa(a,b,c,d){f.each(b,function(e,g){var h=g.appPrefix?g.appPrefix:a?a:"";jiant.logInfo("binding UI for view: "+e+" using prefix "+h);var k=d.view(h,e);O(h,c.dirtyList,k,h+e)&&La(c,b[e],e,g,k,h);Ma(b[e],k);b[e].propagate=pa(e,g,g,b[e]);f.extend(b[e],k);X(k,e,void 0)})}function Pa(a){switch(a){case jiant.label:return"labelTmInner";case jiant.ctl:return"ctlTmInner";case jiant.container:return"containerTmInner";case jiant.containerPaged:return"containerPagedTmInner";
case jiant.form:return"formTmInner";case jiant.pager:return"pagerTmInner";case jiant.image:return"imageTmInner";case jiant.grid:return"gridTmInner";case jiant.input:return"inputTmInner";case jiant.inputInt:return"inputIntTmInner";case jiant.inputFloat:return"inputFloatTmInner";case jiant.inputDate:return"inputDateTmInner";default:return"customTmInner"}}function Qa(a,b,c,d){f.each(b,function(e,g){var h=g.appPrefix?g.appPrefix:a?a:"";jiant.logInfo("binding UI for template: "+e+" using prefix "+h);var k=
d.template(h,e,g);f.each(g,function(a,b){if("appPrefix"!=a)if(b===jiant.lookup)jiant.logInfo("    loookup element, no checks/bindings: "+a),g[a]=function(){return g.find("."+h+a)};else if(b!==jiant.meta)if(b===jiant.cssMarker)g[a].customRenderer=function(b,c,d,e,g){b=a+"_"+d;g.j_prevMarkerClass&&g.removeClass(g.j_prevMarkerClass);g.j_prevMarkerClass=b;g.addClass(b)};else{var f=d.viewComponent(k,e,h,a,b);O(h,c.dirtyList,f,h+e,h+a);f=Pa(g[a]);g[a]={};g[a][f]=!0}});O(h,c.dirtyList,k,h+e);b[e].parseTemplate=
function(a){var d=f("\x3c!-- --\x3e"+E(k,a,e));f.each(g,function(a,g){"parseTemplate"!=a&&"parseTemplate2Text"!=a&&"appPrefix"!=a&&(d[a]=f.merge(d.filter("."+h+a),d.find("."+h+a)),g===V&&la(c,d[a]),ma(c,d[a],b[e][a],e,a),X(d[a],e,a))});d.splice(0,1);d.propagate=pa(e,g,d,d);a&&d.propagate(a);return d};b[e].parseTemplate2Text=function(a){return E(k,a)}})}function Ra(a,b,c){a[c].asap=function(d){var e;jiant.DEBUG_MODE.events&&(r("assigning event handler to "+b),n[b]&&r(" !!! Event handler assigned after fire occured, possible error, for event "+
b),e=G());var g=a[c]();if(void 0!=g)d&&d.apply(d,[a,g]);else a._innerData.one(b,function(){w("called event handler: "+b+", registered at "+e);var a=f.makeArray(arguments);a.splice(0,1);d&&d.apply(d,a)})}}function I(a,b,c,d){d=d?d:a._innerData;var e=function(e){var g;jiant.DEBUG_MODE.events&&(r("assigning event handler to "+b),n[b]&&r(" !!! Event handler assigned after fire occured, possible error, for event "+b),g=G());(c?a[c]:a).listenersCount++;var m=function(){w("called event handler: "+b+", registered at "+
g);var a=f.makeArray(arguments);a.splice(0,1);e&&e.apply(e,a)};d.on(b,m);return m},g=function(e){(c?a[c]:a).listenersCount--;d.off(b,e)};c?(a[c].on=e,a[c].off=g,a[c].listenersCount=0,Ra(a,b,c)):(a.on=e,a.off=g,a.listenersCount=0)}function qa(a,b,c,d){var e=[];c._sourceObjectData={};b.updateAll&&b.id&&(b.update||(b.update=function(a){}),b.findById||(b.findById=function(a){}));b.updateAll&&(b.addAll||(b.addAll=function(a){}),b.remove||(b.remove=function(a){}));b.update||f.each(b,function(a,c){if(0==
a.indexOf("set")&&3<a.length&&(""+c).indexOf("{}")==(""+c).length-2)return b.update=function(a){},!1});c._innerData=f({});f.each(b,function(g,h){var k=a+"_"+g+"_event",m=d+a+"_globalevent";if("_innerData"!=g)if("all"==g)c[g]=function(){var a=[];f.each(e,function(b,c){a.push(c)});return a};else if("on"==g)I(c,m,void 0,q);else if("update"==g)c[g]=function(d,e){var h=!1,ka={};e&&f.each(c._sourceObjectData,function(a,b){void 0==d[a]&&(d[a]=null)});f.each(d,function(a,b){c[a]&&f.isFunction(c[a])&&c[a]()!=
b&&(c[a](b,!1),h=ka[a]=!0)});f.each(ka,function(a,b){c[a](c[a](),!0,!0)});A("Called update on model "+a+" with data",d);h&&(w("fire event: "+k),jiant.DEBUG_MODE.events&&!n[k]&&(n[k]=1),c._innerData.trigger(k,c),c!=b&&b._innerData.trigger(k,c),w("fire event: "+m),jiant.DEBUG_MODE.events&&!n[m]&&(n[m]=1),q.trigger(m,[c,g]))},I(c,k,g);else if("updateAll"==g)c[g]=function(b,d,g){A("Called updateAll on model "+a+" with data",b);b=f.isArray(b)?b:[b];g=g?g:function(a,b){return a.id?a.id()==b.id:!1};var h=
[],k=[];f.each(b,function(a,b){k.push(b)});f.each(e,function(a,c){var e;f.each(b,function(a,b){return g(c,b)?(e=b,!1):!0});var m=k.indexOf(e);d&&!e&&h.push(c);e&&0<=a&&k.splice(m,1);e&&c.update(e)});d&&f.each(h,function(a,b){c.remove(b)});0<k.length&&c.addAll(k)},I(c,k,g);else if("addAll"==g||"add"==g)c[g]=function(h){function H(c){var g={};e.push(g);l.push(g);qa(a,b,g,d);f.each(c,function(a,b){g[a]&&g[a](b)})}A("Called "+g+" on model "+a+" with data",h);if(void 0!=h&&null!=h&&(h=f.isArray(h)?h:[h],
0!=h.length)){var l=[];f.each(h,function(a,b){H(b)});w("fire event: "+k);jiant.DEBUG_MODE.events&&!n[k]&&(n[k]=1);c._innerData.trigger(k,[l]);w("fire event: "+m);jiant.DEBUG_MODE.events&&!n[m]&&(n[m]=1);q.trigger(m,[l,g]);f.each(h,function(a,b){l[a].update&&l[a].update(b)});return l}},I(c,k,g);else if("remove"==g)c[g]=function(a){if(void 0!=a&&null!=a){var b=e.length;e=f.grep(e,function(b){return b!=a});e.length!=b&&(w("fire event: "+k),jiant.DEBUG_MODE.events&&!n[k]&&(n[k]=1),c._innerData.trigger(k,
[a]),w("fire event: "+m),jiant.DEBUG_MODE.events&&!n[m]&&(n[m]=1),q.trigger(m,[a,g]));return a}},I(c,k,g);else if(0==g.indexOf("findBy")&&6<g.length){var l=g.substring(6).split("And");c[g]=function(){function a(b,c,d){return f.grep(b,function(a){return void 0==d||a[c]()==d})}var b=e,c=arguments;f.each(l,function(d,e){var g=e.substring(0,1).toLowerCase()+e.substring(1);b=a(b,g,c[d])});return b[0]}}else if(0==g.indexOf("listBy")&&6<g.length)l=g.substring(6).split("And"),c[g]=function(){function a(b,
c,d){return f.grep(b,function(a){return void 0==d||a[c]()==d})}var b=e,c=arguments;f.each(l,function(d,e){var g=e.substring(0,1).toLowerCase()+e.substring(1);b=a(b,g,c[d])});return b};else if(0==g.indexOf("set")&&3<g.length)l=g.substring(3).split("And"),c[g]=function(){var a=arguments,b={};f.each(l,function(c,d){var e=d.substring(0,1).toLowerCase()+d.substring(1);b[e]=a[c]});c.update(b);return b};else if("asMap"==g)c[g]=function(){return c._sourceObjectData};else if(aa(h)||b._innerData[g])b._innerData[g]=
!0,c[g]=function(a,d,e){if(0!=arguments.length)if(d||c._sourceObjectData[g]!==a&&!1!==d){var f=c._sourceObjectData[g];c._sourceObjectData[g]=a;w("fire event: "+k);jiant.DEBUG_MODE.events&&!n[k]&&(n[k]=1);c._innerData.trigger(k,[c,a,f]);c!=b&&b._innerData.trigger(k,[c,a,f]);e||(w("fire event: "+m),jiant.DEBUG_MODE.events&&!n[m]&&(n[m]=1),q.trigger(m,[c,g,a,f]))}else c._sourceObjectData[g]=a;return c._sourceObjectData[g]},I(c,k,g)})}function aa(a){return(""+a).indexOf("{}")==(""+a).length-2}function Sa(a,
b){f.each(a,function(a,d){jiant.logInfo("implementing model "+a);qa(a,d,d,b)})}function Ta(a,b){f.each(a,function(a,d){jiant.logInfo("binding logic "+a);f.isFunction(d)?aa(d)&&jiant.logError("don't declare empty logic functions, use objects for namespace grouping"):(f.each(d,function(b,g){if(f.isFunction(g)){var h=ra(g);aa(g)&&(d[b]=function(){jiant.logError("Logic function app.logics."+a+"."+b+" called before implemented!")},d[b].empty=!0);d[b].params=h;d[b].spec=!0}}),d.implement=function(e){f.each(d,
function(a,b){f.isFunction(b)&&"implement"!=a&&(e[a]?d[a]=e[a]:jiant.logError("Logic function "+a+" is not implemented by declared implementation"))});ba(b,a);!u[b]&&(u[b]={});u[b][a]=1;sa(b,a)},"intl"==a&&Ua(d))})}function sa(a,b){var c=0;f.each(p[a],function(){c++});jiant.logInfo("implementation assigned to "+b+", remaining unbound logics count: "+c+(0==c?", all logics loaded OK!":""))}function ta(a,b,c){var d=[];f.isArray(a)||(a=[a]);f.each(a,function(a,b){var c="ext"+(new Date).getTime()+Math.random();
d.push(c);ua(c,b)});a="app"+(new Date).getTime()+Math.random();jiant.onUiBound(a,d,b);jiant.bindUi({id:a},c)}function ua(a,b){function c(){d&&jiant.info("Loaded external library "+b);J[a]=d?{}:b;f.each(p,function(b,c){va(b,a)});f.each(p,function(b,c){wa(b,a)})}var d="string"===typeof b;d&&jiant.info("Start loading external library "+b);d?f.ajax({url:b,cache:!0,crossDomain:!0,dataType:"script",success:c}):c()}function va(a,b){var c=J[b];c&&p[a][b]&&s[a]&&(s[a].logic||(s[a].logic={}),s[a].logic[b]||
(s[a].logic[b]={}),f.each(c,function(c,e){s[a].logic[b][c]=e}))}function wa(a,b){J[b]&&p[a][b]&&s[a]&&(ba(a,b),u[a][b]=1,sa(a,b))}function ba(a,b){if(p[a]&&p[a][b]){var c=p[a][b];delete p[a][b];c&&f.each(c,function(c,e){q.trigger(a+"jiant_dependency_resolved_"+b)})}}function Va(a,b){f.each(a,function(c,d){B("binding event: "+c);a[c].listenersCount=0;a[c].fire=function(){w("fire event: "+c);jiant.DEBUG_MODE.events&&!n[c]&&(n[c]=1);q.trigger(b+c+".event",arguments)};a[c].on=function(d){var g;jiant.DEBUG_MODE.events&&
(r("assigning event handler to: "+c),n[c]&&r(" !!! Event handler assigned after fire occured, possible error, for event "+c),g=G());a[c].listenersCount++;q.on(b+c+".event",function(){w("called event handler: "+c+", registered at "+g);var a=f.makeArray(arguments);a.splice(0,1);d&&d.apply(d,a)})}})}function Wa(a,b,c){f(window).hashchange?(f.each(a,function(a,e){B("binding state: "+c+a);e.go=Xa(a,e.root,b,c);e.start=function(b){var e;jiant.DEBUG_MODE.states&&(r("register state start handler: "+c+a),
P[c+a]&&r(" !!! State start handler registered after state triggered, possible error, for state "+c+a),e=G());q.on(c+"state_"+a+"_start",function(){N("called state start handler: "+c+a+", registered at "+e);var k=f.makeArray(arguments);k.splice(0,1);b&&b.apply(b,k)});var k=K(c);s[c]&&(""==a&&0==k.now.length||k.now[0]==a)&&(k=k.now,k.splice(0,1),b&&b.apply(b,k))};e.end=function(b){var e;jiant.DEBUG_MODE.states&&(r("register state end handler: "+c+a),P[c+a]&&r(" !!! State end handler registered after state triggered, possible error, for state "+
a),e=G());q.on(c+"state_"+a+"_end",function(){N("called state end handler: "+c+a+", registered at "+e);var k=f.makeArray(arguments);k.splice(0,1);b&&b.apply(b,k)})}}),f(window).hashchange(Ya(c)),D[c]=K(c).now[0],ca[c]=Q(c)):(jiant.logError("No hashchange plugin and states configured. Don't use states or add hashchange plugin (supplied with jiant)"),jiant.DEV_MODE&&alert("No hashchange plugin and states configured. Don't use states or add hashchange plugin (supplied with jiant)"))}function Ya(a){return function(b,
c,d){if(!d||d==a){location.hash.substring(1);b=K(a);d=b.now[0];var e=b.now;if(c||ca[a]!=Q(a))e.splice(0,1),f.each(e,function(a,b){"undefined"==b&&(e[a]=void 0)}),void 0!=D[a]&&D[a]!=d&&(N("trigger state end: "+a+(D[a]?D[a]:"")),q.trigger(a+"state_"+D[a]+"_end")),D[a]=d,ca[a]=Q(a),d=d?d:"",N("trigger state start: "+a+d),jiant.DEBUG_MODE.states&&!P[a+d]&&(P[a+d]=1),q.trigger(a+"state_"+d+"_start",e)}}}function Xa(a,b,c,d){return function(){var e=K(d),g=e.now;e.now=[a];A("Going to state "+a+" with data",
arguments);f.each(arguments,function(b,c){void 0!=c?e.now.push(y(c)):g[0]!=a&&!xa(d,g[0],a)||void 0==g[b+1]?e.now.push(y(c)):(M("reusing pref param: "+g[b+1]),e.now.push(y(g[b+1])))});if(g&&(g[0]==a||xa(d,g[0],a)))for(var h=arguments.length;h<g.length-1;)M("pushing prevState param: "+g[h]),e.now.push(y(g[++h]));b?(e.root=[],f.each(e.now,function(a,b){e.root.push(b)})):f.each(e.root,function(a,b){e.root[a]=y(b)});ya(e,c,d)}}function xa(a,b,c){a=s[a].states;return void 0!==a[b].statesGroup&&a[b].statesGroup===
a[c].statesGroup}function ya(a,b,c){var d=R(),e="",g=a.now+"|"+a.root;f.each(d,function(a,b){e=c==a?e+(a+"="+g+"="):e+(a+"="+b+"=")});d[c]||(e+=c+"="+g+"=");a=b||""==b?b:jiant.STATE_EXTERNAL_BASE;window.location.assign((a?a:"")+"#"+e);f(window).hashchange()}function R(){var a=location.hash.substring(1).split("="),b={};f.each(a,function(c,d){0==c%2&&d&&void 0!=a[c+1]&&(b[d]=a[c+1])});return b}function Q(a){if(a)return a=R()[a],void 0==a?"":a;var b="";f.each(R(),function(a,d){b=d;return!1});return b}
function K(a){a=Q(a).split("|");var b={now:[],root:[]};f.each(a,function(a,d){var e=d.split(",");f.each(e,function(d,e){b[0==a?"now":"root"].push(da(e))})});b.now=b.now||[];b.root=b.root||[];return b}function y(a){if(f.isPlainObject(a)){var b="{";f.each(a,function(a,d){b+=y(a);b+=":";b+=y(d);b+="}"});b="}"==b[b.length-1]?b.substring(0,b.length-1):b;return y(b)}return(a+="")?a.replace(Za,function(a){return za[a]}):""}function da(a){if((a=a?a.replace($a,function(a){return Aa[a]}):"")&&"{"==a[0]){var b=
{};a=a.substring(1,a.length).split("}");f.each(a,function(a,d){var e=d.split(":");2==e.length&&(b[da(e[0])]=da(e[1]))});return b}return a}function ra(a){a=a.toString();return a.slice(a.indexOf("(")+1,a.indexOf(")")).match(/([^\s,]+)/g)}function ab(a,b,c,d){f.each(a,function(e,g){B("binding ajax for function: "+e);var h=ra(g);h&&0<h.length?h.splice(h.length-1,1):h=[];a[e]=bb(b,c,e,h,f.isFunction(a[e])?a[e]():void 0,d);a[e]._jiantSpec=h})}function Ba(a,b,c){f.isArray(c)?a[b]=c:f.isPlainObject(c)?f.each(c,
function(b,c){Ba(a,b,c)}):a[b]=c}function bb(a,b,c,d,e,g){return function(){var h={},k,m,l=arguments;f.isFunction(l[l.length-2])?(k=l[l.length-2],m=l[l.length-1]):f.isFunction(l[l.length-1])&&(k=l[l.length-1]);f.each(d,function(a,b){a<l.length&&!f.isFunction(l[a])&&void 0!=l[a]&&null!=l[a]&&Ba(h,b,l[a])});h.antiCache3721||(h.antiCache3721=(new Date).getTime());var n=a||""==a?a:jiant.AJAX_PREFIX,p=b||""==b?b:jiant.AJAX_SUFFIX,n=e?e:n+c+p,q=(new Date).getTime();B("    AJAX call. "+c+" to server url: "+
n);p={data:h,traditional:!0,success:function(a){B("               "+c+" executed in "+((new Date).getTime()-q));if(k){try{a=f.parseJSON(a)}catch(b){}jiant.DEBUG_MODE.ajax&&r("   ---   Ajax call results for uri "+c)&&r(a);k(a)}},error:function(a,b,c){m?m(a.responseText):jiant.handleErrorFn(a.responseText)}};g&&(p.contentType="application/json",p.dataType="jsonp",p.xhrFields={withCredentials:!0},p.crossDomain=!0);f.ajax(n,p)}}function Ca(a,b,c){if(a.logic.intl){var d=b[c];b[c]=function(c){if(void 0==
c)return d.call(b);u[a.id]&&u[a.id].intl?d.call(b,a.logic.intl.t(c)):(d.call(b,c),Da(a,["intl"],function(){d.call(b,a.logic.intl.t(c))}))}}else U("nlabel used, but no intl declared, degrading nlabel to label")}function la(a,b){Ca(a,b,"html");Ca(a,b,"text")}function cb(a,b,c){b&&(a.logic.intl?jiant.logError("Both logic.intl and app.intl declared, skipping app.intl"):a.logic.intl=b)}function Ua(a){jiant.logInfo("Loading intl: ",a);a.url?(a.t=function(a){},a.t.spec=!0,a.t.empty=!0,f.getJSON(a.url,function(b){var c=
{};f.each(a,function(a,e){e.spec&&(c[a]=db(a,e,b))});a.implement(c)})):U("Intl data url not provided, internationalization will not be loaded")}function ea(a,b){if(b||""==b)return b;jiant.error("Not found translation for key: ",a);return a}function db(a,b,c){return"t"==a?function(a){return ea(a,c[a])}:b.empty?b.params?function(b){return ea(a+b,c[a+b])}:function(){return ea(a,c[a])}:b}function C(a,b,c){if(a[b])return!0;if(a[c])return a[b]=a[c],!0;a[b]={};return!1}function Ea(a,b,c,d){jiant.DEV_MODE=
c;!c&&0<=(window.location+"").toLowerCase().indexOf("jiant.dev_mode")&&(jiant.DEV_MODE=!0);0<=(window.location+"").toLowerCase().indexOf("jiant.debug_events")&&(jiant.DEBUG_MODE.events=1);0<=(window.location+"").toLowerCase().indexOf("jiant.debug_states")&&(jiant.DEBUG_MODE.states=1);0<=(window.location+"").toLowerCase().indexOf("jiant.debug_ajax")&&(jiant.DEBUG_MODE.ajax=1);0<=(window.location+"").toLowerCase().indexOf("jiant.debug_data")&&(jiant.DEBUG_MODE.data=1);L="";Y=!0;var e=b.id?b.id:"no_app_id";
b.id?jiant.logInfo("Loading application, id: "+b.id):jiant.logError("!!! Application id not specified. Not recommended since 0.20. Use 'id' property of application root to specify application id");s[e]?jiant.logError("Application '"+e+"' already loaded, skipping multiple bind call"):(C(b,"logic","l"),C(b,"intl","i")&&cb(b,b.intl,e),C(b,"views","v")&&Oa(a,b.views,b,d),C(b,"templates","t")&&Qa(a,b.templates,b,d),C(b,"ajax","a")&&ab(b.ajax,b.ajaxPrefix,b.ajaxSuffix,b.crossDomain),C(b,"events","e")&&
Va(b.events,e),C(b,"states","s")&&Wa(b.states,b.stateExternalBase,e),C(b,"models","m")&&Sa(b.models,e),Ta(b.logic,e),jiant.DEV_MODE&&!Y&&alert("Some elements not bound to HTML properly, check console"+L),s[e]=b,jiant.logInfo(b),u[e]||(u[e]={}),f.each(J,function(a,b){u[e][a]||(u[e][a]=J[a]);ba(e,a)}),q.trigger(e+"onAppInit"+e),f.when.apply(f,Fa).done(function(){q.trigger(e+"jiant_uiBound_"+e)}))}function eb(a){return f.isPlainObject(a)?a.id:a}function Da(a,b,c){c||b?c||(c=b,b=[]):(jiant.logError("!!! Registering anonymous logic without application id. Not recommended since 0.20"),
c=a,a=["no_app_id"]);f.isArray(a)||(a=[a]);1<a.length&&f.isArray(b)&&0<b.length?f.each(b,function(a,b){f.isArray(b)||jiant.logError("Used multiple applications onUiBound and supplied wrong dependency list, use multi-array, like [[app1DepList], [app2DepList]]")}):1==a.length&&b&&b.length?b=[b]:b||(b=[]);f.each(a,function(d,e){f.isPlainObject(e)&&(e=e.id,a[d]=e);!p[e]&&(p[e]={});!u[e]&&(u[e]={});b[d]&&f.each(b[d],function(a,b){!p[e][b]&&(p[e][b]=[]);!u[e][b]&&J[b]&&(va(e,b),wa(e,b));!u[e][b]&&p[e][b].push(c)})});
fa(a,c)}function fa(a,b){var c=!0;f.each(a,function(d,e){if(!s[e])return q.one(e+"jiant_uiBound_"+e,function(){fa(a,b)}),c=!1});if(c){var d=!0,e=[f];f.each(a,function(c,h){f.each(p[h],function(c,e){d=d&&0>f.inArray(b,e);!d&&q.one(h+"jiant_dependency_resolved_"+c,function(){fa(a,b)});return d});if(!d)return!1;e.push(s[h])});d&&b.apply(b,e)}}var oa={},V={},Y=!0,L,ga,D={},ca={},u={},p={},J={},q=f({}),s={},Fa=[],W=new Ga,P={},n={},za={";":";;",",":";1","=":";2","|":";3","{":";4","}":";5",":":";6","#":";7",
"'":";7"},Aa={},Za=/;|,|=|\||\{|\}|:|#/gi,$a=/;;|;1|;2|;3|;4|;5|;6|;7/gi;f.each(za,function(a,b){Aa[b]=a});return{AJAX_PREFIX:"",AJAX_SUFFIX:"",DEV_MODE:!1,DEBUG_MODE:{states:0,events:0,ajax:0,data:0},PAGER_RADIUS:6,isMSIE:eval("/*@cc_on!@*/!1"),STATE_EXTERNAL_BASE:void 0,getAwaitingDepends:function(){return p},bind:function(a,b){f.extend(a,b)},bindUi:function(a,b,c,d,e){var g=(new Date).getTime();f.isPlainObject(a)&&(e=d,d=c,c=b,b=a,a=b.appPrefix);var h=b.uiFactory?b.uiFactory:W;if(d){var k;e?(k=
f("#"+e),k[0]||(k=f("<div id='"+e+"' style='display:none'></div>"),f("body").append(k))):k=f("body");k.load(d,{},function(){Ea(a,b,c,h)})}else Ea(a,b,c,h);jiant.logInfo("UI bound in "+((new Date).getTime()-g)+"ms");c&&setTimeout(function(){0<p.length&&F("Attention!! Some depends are not resolved",p)},1E4)},declare:ua,loadLibs:ta,goRoot:function(a){function b(a){var b=K(a);b.now=[];f.each(b.root,function(a,c){b.now.push(y(c));b.root[a]=y(c)});ya(b,void 0,a)}a&&b(a);!a&&f.each(R(),function(a,d){b(a)})},
goState:function(a,b){},onUiBound:Da,onAppInit:function(a,b){var c=new f.Deferred;Fa.push(c.promise());var d=function(){c.resolve()};if(s[a])jiant.logError("Defining and calling onUiBound() before onAppInit().");else q.on(a+"onAppInit"+a,function(){b&&b(f,s[a],d)})},refreshState:function(a){f(window).hashchange&&f(window).trigger("hashchange",[!0,eb(a)])},getCurrentState:function(a){a=K(a);return a.now[0]?a.now[0]:""},setUiFactory:function(a){var b=!0;f.each(["template","viewComponent","view"],function(c,
d){a[d]||(jiant.logError("UI Factory doesn't implement method "+d+", ignoring bad factory"),b=!1)});b&&(W=a)},visualize:function(a){ta(["https://raw.github.com/vecnas/jiant/master/graph.js"],function(){a||f.each(s,function(b,c){a=b;return!1});jiant.onUiBound(a,["jiantVisualizer"],function(a,c){c.logic.jiantVisualizer.visualize(a,c)})},!0)},handleErrorFn:function(a){F(a)},logInfo:B,logError:F,info:M,error:U,infop:function(){ha(B,arguments)},errorp:function(){ha(F,arguments)},parseTemplate:function(a,
b){return f(E(a,b))},parseTemplate2Text:function(a,b){return E(a,b)},version:function(){return 113},formatDate:function(a){a=z(a);return null==a?"":t(a.getFullYear())+"-"+t(a.getMonth()+1)+"-"+t(a.getDate())},formatDateUsa:function(a){a=z(a);return null==a?"":t(a.getMonth()+1)+"/"+t(a.getDate())+"/"+t(a.getFullYear())},formatMoney:function(a,b){b=void 0!==b?b:",";var c=parseInt(a);if(isNaN(c))return"";if(0==c)return"0";for(var d=""+Math.abs(c),e=d.length;0<e;e-=3)d=d.substring(0,e)+(e<d.length?b:
"")+d.substring(e);return(0>c?"-":"")+d},formatTime:function(a){a=z(a);return null==a?"":t(a.getHours())+":"+t(a.getMinutes())},formatTimeSeconds:function(a){a=z(a);return null==a?"":t(a.getHours())+":"+t(a.getMinutes())+":"+t(a.getSeconds())},randomIntBetween:function(a,b){return Math.floor(Math.random()*(b-a+1)+a)},lfill:t,pick:function(a){var b=(new Date).getTime();ga&&M((a?a:"jiant.pick:")+" "+(b-ga)+"ms");ga=b},collection:{},container:{},containerPaged:oa,ctl:{},fn:function(a){},form:{},grid:{},
image:{},input:{},inputDate:{},inputInt:{},inputFloat:{},label:{},nlabel:V,meta:{},cssMarker:{},lookup:function(a){},on:function(a){},pager:{},slider:{},stub:function(){var a="not available";arguments&&arguments.callee&&arguments.callee.caller&&(a=arguments.callee.caller.name);alert("stub called from function: "+a)},tabs:{},key:{left:37,up:38,right:39,down:40,del:46,backspace:8,tab:9,end:35,home:36,enter:13,ctrl:17,escape:27,dot:190,dotExtra:110,comma:188,a:65,c:67,u:85,w:87,space:32,1:49,2:50,3:51,
4:52,5:53,6:54}}}(jQuery);window.jiant&&window.jiant.version&&window.jiant.version()>=S.version()||(window.jiant=S)})();
