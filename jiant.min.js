(function(){var ra=function(){return{template:function(f,w,r){return $("#"+f+w)},viewComponent:function(f,w,r,R,B){return f.find("."+r+R)},view:function(f,w){return $("#"+f+w)}}},Q=function(f){function w(a){var b=Number(a);return 0===b&&0!==a&&"0"!==a||isNaN(b)?null:new Date(b)}function r(a){a=""+a;return 0==a.length?"00":1==a.length?"0"+a:a}function R(a){f.each(a.find("*"),function(a,c){f.each(c.attributes,function(a,b){0>b.value.indexOf(" ")&&0<=b.value.indexOf("!!")&&f(c).attr(b.name,b.value.replace(/!!/g,
"e2013e03e11eee "))})});return f.trim(f(a).html()).replace(/!!/g,"!! ").replace(/e2013e03e11eee /g,"!! ")}function B(a,b,c){x("Called parse template "+(c?c:"")+" with data",b);b=b||{};c=f.trim(f(a).html());var d={},e="";c=jiant.isMSIE?R(f(a)):c.replace(/!!/g,"!! ");try{var g=d[c];if(!g){var h="var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+c.replace(/[\r\t\n]/g," ").replace(/'(?=[^#]*#>)/g,"\t").split("'").join("\\'").split("\t").join("'").replace(/!! (.+?)!! /g,"',$1,'").split("!?").join("');").split("?!").join("p.push('")+
"');}return p.join('');",g=new Function("obj",h);d[c]=g}return f.trim(g(b))}catch(k){e=k.message,J("Error parse template: "+e)}return"!!! ERROR: "+e.toString()+" !!!"}function Q(a){a.keydown(function(b){return b.keyCode==jiant.key.down&&0<a.val()?(a.val(a.val()-1),a.trigger("change"),!1):b.keyCode==jiant.key.up?(a.val(parseInt(a.val())+1),a.trigger("change"),!1):b.keyCode!=jiant.key.backspace&&b.keyCode!=jiant.key.del&&b.keyCode!=jiant.key.end&&b.keyCode!=jiant.key.left&&b.keyCode!=jiant.key.right&&
b.keyCode!=jiant.key.home&&b.keyCode!=jiant.key.tab&&b.keyCode!=jiant.key.enter&&(b.shiftKey||(48>b.keyCode||57<b.keyCode)&&(96>b.keyCode||105<b.keyCode))?(b.preventDefault(),!1):!0})}function sa(a){a.keydown(function(b){return b.keyCode==jiant.key.down&&0<a.val()?(a.val(a.val()-1),a.trigger("change"),!1):b.keyCode==jiant.key.up?(a.val(parseInt(a.val())+1),a.trigger("change"),!1):b.keyCode==jiant.key.dot||b.keyCode==jiant.key.dotExtra?0>a.val().indexOf(".")&&0<a.val().length:b.keyCode!=jiant.key.backspace&&
b.keyCode!=jiant.key.del&&b.keyCode!=jiant.key.end&&b.keyCode!=jiant.key.left&&b.keyCode!=jiant.key.right&&b.keyCode!=jiant.key.home&&b.keyCode!=jiant.key.tab&&b.keyCode!=jiant.key.enter&&(b.shiftKey||(48>b.keyCode||57<b.keyCode)&&(96>b.keyCode||105<b.keyCode))?(b.preventDefault(),!1):!0})}function ta(a,b,c,d){if(b[0]){var e=b[0].tagName.toLowerCase();"form"!=e&&(jiant.logError(c+"."+d+" form element assigned to non-form: "+e),jiant.DEV_MODE&&alert(c+"."+d+" form element assigned to non-form: "+e));
b.submitForm=function(c,e){c=c?c:b.attr("action");c=(a.ajaxPrefix?a.ajaxPrefix:jiant.AJAX_PREFIX?jiant.AJAX_PREFIX:"")+c;c+=a.ajaxSuffix?a.ajaxSuffix:jiant.AJAX_SUFFIX?jiant.AJAX_SUFFIX:"";var d={type:"POST",url:c,data:b.serialize(),success:e};a.crossDomain&&(d.contentType="application/json",d.dataType="jsonp",d.xhrFields={withCredentials:!0},d.crossDomain=!0);x("Submitting form",d);return f.ajax(d)}}}function J(a){f.each(arguments,function(a,c){window.console&&window.console.error&&window.console.error(c)})}
function C(a){jiant.DEV_MODE&&window.console&&window.console.info&&f.each(arguments,function(a,c){window.console.info(c)})}function S(){var a="";f.each(arguments,function(b,c){a+=c;a+=" "});C(a)}function x(a,b){jiant.DEBUG_MODE.data&&q("   ---   "+a)&&q(b)}function L(a){jiant.DEBUG_MODE.states&&q("   ---   "+a)}function u(a){jiant.DEBUG_MODE.events&&q("   ---   "+a)}function q(a){return window.console&&window.console.error?(window.console.error(a),!0):!1}function ua(a){function b(a,b){var h=f(B(f("<b><li class='!!ctlClass!!' style='cursor: pointer;'><a>!!label!!</a></li></b>"),
{label:-1!=a?a:"...",ctlClass:b}));d.append(h);-1!=a&&h.click(function(){c.trigger("ValueChange",a)});return h}var c=f({}),d=f("<ul></ul>");d.addClass("pagination");a.append(d);a.onValueChange=function(a){c.on("ValueChange",a)};a.updatePager=function(a){x("Updating pager",a);d.empty();var c=Math.max(0,a.number-jiant.PAGER_RADIUS/2),f=Math.min(a.number+jiant.PAGER_RADIUS/2,a.totalPages);0<c&&(b(1,""),b(-1,"disabled emptyPlaceholder"));for(;c<f;c++){var k="";c==a.number&&(k+=" active");b(c+1,k)}f<a.totalPages-
1&&(b(-1,"disabled emptyPlaceholder"),b(a.totalPages,""))}}function va(a){function b(){h=Math.max(h,0);h=Math.min(h,e.children().length-1);c.css("visibility",0<h?"visible":"hidden");d.css("visibility",h<e.children().length-g?"visible":"hidden");f.each(e.children(),function(a,b){var c=f(b);a>=h&&a<h+g?c.show():c.hide()})}var c=f("<div>&laquo;</div>"),d=f("<div>&raquo;</div>"),e=f("<div></div>"),g=8,h=0;c.addClass("paged-prev");d.addClass("paged-next");e.addClass("paged-container");a.empty();a.append(c);
a.append(e);a.append(d);c.click(function(){h-=g;b()});d.click(function(){h+=g;b()});a.append=function(a){e.append(a);b()};a.empty=function(){e.empty();b()};a.setHorizontal=function(a){a=a?"inline-block":"block";c.css("display",a);d.css("display",a);e.css("display",a)};a.setPageSize=function(a){g=a;b()};a.setHorizontal(!0)}function D(){var a={stack:{}};Error.captureStackTrace&&Error.captureStackTrace(a,D);return a.stack}function wa(a,b,c,d,e,g){var h={};f.each(d,function(d,f){h[d]=d;if("appPrefix"!=
d)if(b[d]==jiant.lookup)jiant.logInfo("    loookup element, no checks/bindings: "+d),b[d]=function(){return e.find("."+g+d)};else if(b[d]!=jiant.meta){var n=T.viewComponent(e,c,g,d,f);M(g,a.dirtyList,n,g+c,g+d);b[d]=n;ba(a,n,f,c,d)}});b._jiantSpec=h}function xa(a,b){f.each(a,function(a,d){b[a]&&(jiant.logError("unsafe extension: "+a+" already defined in base jQuery, shouldn't be used, now overriding!"),b[a]=void 0)})}function ca(a){var b=typeof a;if("object"!=b||null===a)return"string"==b&&(a='"'+
a+'"'),String(a);var c=[],d=a&&a.constructor==Array;f.each(a,function(a,g){b=typeof g;"string"==b?g='"'+g+'"':"object"==b&&null!==g&&(g=ca(g));c.push((d?"":'"'+a+'":')+(g?g:'""'))});return(d?"[":"{")+String(c)+(d?"]":"}")}function U(a,b,c){jiant.DEV_MODE&&a.click(function(d){if(d.shiftKey&&d.altKey){var e=b+(c?"."+c:"");d.ctrlKey&&(e=e+"\r\n------------\r\n"+ca(f._data(a[0],"events")));jiant.logInfo(e);alert(e);d.preventDefault();d.stopImmediatePropagation()}})}function M(a,b,c,d,e){return d&&b&&
(0<=f.inArray(d,b)||a&&0<=f.inArray(d.substring(a.length),b))?!0:c&&c.length?!0:(window.console&&window.console.error&&(e?jiant.logError("non existing object referred by class under object id '"+d+"', check stack trace for details, expected obj class: "+e):jiant.logError("non existing object referred by id, check stack trace for details, expected obj id: "+d)),K=e?K+("   ,    #"+d+" ."+e):K+(", #"+d),V=!1)}function ba(a,b,c,d,e){(c==jiant.tabs||c.tabsTmInner)&&b.tabs?(b.tabs(),b.refreshTabs=function(){b.tabs("refresh")}):
c==jiant.inputInt||c.inputIntTmInner?Q(b):c==jiant.inputFloat||c.inputFloatTmInner?sa(b):(c==jiant.inputDate||c.inputDateTmInner)&&b.datepicker?b.datepicker():c==jiant.pager||c.pagerTmInner?ua(b):c==jiant.form||c.formTmInner?ta(a,b,d,e):(c==da||c.containerPagedTmInner)&&va(b);U(b,d,e)}function ea(a,b,c,d){var e={};f.each(b,function(a,b){e[a]=b});var g=function(h,k){x("Propagating "+a+" with data",h);k=void 0==k?!0:k;f.each(e,function(a,e){if(b[a].customRenderer||h&&void 0!=h[a]&&null!=h[a]&&!(0<=
f.inArray(a,["parseTemplate","parseTemplate2Text","propagate"]))){var E=h[a];e=c[a];if(f.isFunction(E)){if(W(b,a)(h,e,E(),!1,d),k&&f.isFunction(E.on)){if(g[a]){var F=g[a][0];F&&F(g[a][1])}F=E.on(function(c,g){W(b,a)(h,e,g,!0,d)});g[a]=[E.off,F]}}else W(b,a)(h,e,E,!1,d)}})};return g}function W(a,b){return a[b]&&a[b].customRenderer&&f.isFunction(a[b].customRenderer)?a[b].customRenderer:ya}function ya(a,b,c,d,e){b&&b[0]&&(a=["text","hidden",void 0],d=b[0].tagName.toLowerCase(),"input"==d||"textarea"==
d||"select"==d?(d=f(b[0]).attr("type"),0<=f.inArray(d,a)?b.val(c):"checkbox"==d?b.prop("checked",c?!0:!1):"radio"==d&&f.each(b,function(a,b){f(b).prop("checked",b.value==c)})):"img"==d?b.attr("src",c):b.html(c))}function za(a,b,c,d){f.each(b,function(e,g){var h=g.appPrefix?g.appPrefix:a?a:"";jiant.logInfo("binding UI for view: "+e+" using prefix "+h);var k=d.view(h,e);M(h,c.dirtyList,k,h+e)&&wa(c,b[e],e,g,k,h);xa(b[e],k);b[e].propagate=ea(e,g,g,b[e]);f.extend(b[e],k);U(k,e,void 0)})}function Aa(a){switch(a){case jiant.label:return"labelTmInner";
case jiant.ctl:return"ctlTmInner";case jiant.container:return"containerTmInner";case jiant.containerPaged:return"containerPagedTmInner";case jiant.form:return"formTmInner";case jiant.pager:return"pagerTmInner";case jiant.image:return"imageTmInner";case jiant.grid:return"gridTmInner";case jiant.input:return"inputTmInner";case jiant.inputInt:return"inputIntTmInner";case jiant.inputFloat:return"inputFloatTmInner";case jiant.inputDate:return"inputDateTmInner";default:return"customTmInner"}}function Ba(a,
b,c,d){f.each(b,function(e,g){var h=g.appPrefix?g.appPrefix:a?a:"";jiant.logInfo("binding UI for template: "+e+" using prefix "+h);var k=d.template(h,e,g);f.each(g,function(a,b){if("appPrefix"!=a)if(g[a]==jiant.lookup)jiant.logInfo("    loookup element, no checks/bindings: "+a),g[a]=function(){return g.find("."+h+a)};else if(g[a]!=jiant.meta){var f=d.viewComponent(k,e,h,a,b);M(h,c.dirtyList,f,h+e,h+a);f=Aa(g[a]);g[a]={};g[a][f]=!0}});M(h,c.dirtyList,k,h+e);b[e].parseTemplate=function(a){var d=f("\x3c!-- --\x3e"+
B(k,a,e));f.each(g,function(a,g){"parseTemplate"!=a&&"parseTemplate2Text"!=a&&"appPrefix"!=a&&(d[a]=f.merge(d.filter("."+h+a),d.find("."+h+a)),ba(c,d[a],b[e][a],e,a),U(d[a],e,a))});d.splice(0,1);d.propagate=ea(e,g,d,d);a&&d.propagate(a);return d};b[e].parseTemplate2Text=function(a){return B(k,a)}})}function Ca(a,b,c){a[c].asap=function(d){var e;jiant.DEBUG_MODE.events&&(q("assigning event handler to "+b),m[b]&&q(" !!! Event handler assigned after fire occured, possible error, for event "+b),e=D());
var g=a[c]();if(void 0!=g)d&&d.apply(d,[a,g]);else a._innerData.one(b,function(){u("called event handler: "+b+", registered at "+e);var a=f.makeArray(arguments);a.splice(0,1);d&&d.apply(d,a)})}}function H(a,b,c,d){d=d?d:a._innerData;var e=function(e){var g;jiant.DEBUG_MODE.events&&(q("assigning event handler to "+b),m[b]&&q(" !!! Event handler assigned after fire occured, possible error, for event "+b),g=D());(c?a[c]:a).listenersCount++;var l=function(){u("called event handler: "+b+", registered at "+
g);var a=f.makeArray(arguments);a.splice(0,1);e&&e.apply(e,a)};d.on(b,l);return l},g=function(e){(c?a[c]:a).listenersCount--;d.off(b,e)};c?(a[c].on=e,a[c].off=g,a[c].listenersCount=0,Ca(a,b,c)):(a.on=e,a.off=g,a.listenersCount=0)}function ga(a,b,c,d){var e=[];c._sourceObjectData={};b.updateAll&&b.id&&(b.update||(b.update=function(a){}),b.findById||(b.findById=function(a){}));b.updateAll&&(b.addAll||(b.addAll=function(a){}),b.remove||(b.remove=function(a){}));b.update||f.each(b,function(a,c){if(0==
a.indexOf("set")&&3<a.length&&(""+c).indexOf("{}")==(""+c).length-2)return b.update=function(a){},!1});c._innerData=f({});f.each(b,function(g,h){var k=a+"_"+g+"_event",l=d+a+"_globalevent";if("_innerData"!=g)if("all"==g)c[g]=function(){var a=[];f.each(e,function(b,c){a.push(c)});return a};else if("on"==g)H(c,l,void 0,p);else if("update"==g)c[g]=function(d,e){var h=!1,fa={};e&&f.each(c._sourceObjectData,function(a,b){void 0==d[a]&&(d[a]=null)});f.each(d,function(a,b){c[a]&&f.isFunction(c[a])&&c[a]()!=
b&&(c[a](b,!1),h=fa[a]=!0)});f.each(fa,function(a,b){c[a](c[a](),!0,!0)});x("Called update on model "+a+" with data",d);h&&(u("fire event: "+k),jiant.DEBUG_MODE.events&&!m[k]&&(m[k]=1),c._innerData.trigger(k,c),c!=b&&b._innerData.trigger(k,c),u("fire event: "+l),jiant.DEBUG_MODE.events&&!m[l]&&(m[l]=1),p.trigger(l,[c,g]))},H(c,k,g);else if("updateAll"==g)c[g]=function(b,d,g){x("Called updateAll on model "+a+" with data",b);b=f.isArray(b)?b:[b];g=g?g:function(a,b){return a.id?a.id()==b.id:!1};var h=
[],k=[];f.each(b,function(a,b){k.push(b)});f.each(e,function(a,c){var e;f.each(b,function(a,b){return g(c,b)?(e=b,!1):!0});var l=k.indexOf(e);d&&!e&&h.push(c);e&&0<=a&&k.splice(l,1);e&&c.update(e)});d&&f.each(h,function(a,b){c.remove(b)});0<k.length&&c.addAll(k)},H(c,k,g);else if("addAll"==g||"add"==g)c[g]=function(h){function F(c){var g={};e.push(g);G.push(g);ga(a,b,g,d);f.each(c,function(a,b){g[a]&&g[a](b)})}x("Called "+g+" on model "+a+" with data",h);if(void 0!=h&&null!=h&&(h=f.isArray(h)?h:[h],
0!=h.length)){var G=[];f.each(h,function(a,b){F(b)});u("fire event: "+k);jiant.DEBUG_MODE.events&&!m[k]&&(m[k]=1);c._innerData.trigger(k,[G]);u("fire event: "+l);jiant.DEBUG_MODE.events&&!m[l]&&(m[l]=1);p.trigger(l,[G,g]);f.each(h,function(a,b){G[a].update&&G[a].update(b)});return G}},H(c,k,g);else if("remove"==g)c[g]=function(a){if(void 0!=a&&null!=a){var b=e.length;e=f.grep(e,function(b){return b!=a});e.length!=b&&(u("fire event: "+k),jiant.DEBUG_MODE.events&&!m[k]&&(m[k]=1),c._innerData.trigger(k,
[a]),u("fire event: "+l),jiant.DEBUG_MODE.events&&!m[l]&&(m[l]=1),p.trigger(l,[a,g]));return a}},H(c,k,g);else if(0==g.indexOf("findBy")&&6<g.length){var n=g.substring(6).split("And");c[g]=function(){function a(b,c,d){return f.grep(b,function(a){return void 0==d||a[c]()==d})}var b=e,c=arguments;f.each(n,function(d,e){var g=e.substring(0,1).toLowerCase()+e.substring(1);b=a(b,g,c[d])});return b[0]}}else if(0==g.indexOf("listBy")&&6<g.length)n=g.substring(6).split("And"),c[g]=function(){function a(b,
c,d){return f.grep(b,function(a){return void 0==d||a[c]()==d})}var b=e,c=arguments;f.each(n,function(d,e){var g=e.substring(0,1).toLowerCase()+e.substring(1);b=a(b,g,c[d])});return b};else if(0==g.indexOf("set")&&3<g.length)n=g.substring(3).split("And"),c[g]=function(){var a=arguments,b={};f.each(n,function(c,d){var e=d.substring(0,1).toLowerCase()+d.substring(1);b[e]=a[c]});c.update(b);return b};else if("asMap"==g)c[g]=function(){return c._sourceObjectData};else if(X(h)||b._innerData[g])b._innerData[g]=
!0,c[g]=function(a,d,e){if(0!=arguments.length)if(d||c._sourceObjectData[g]!==a&&!1!==d){var f=c._sourceObjectData[g];c._sourceObjectData[g]=a;u("fire event: "+k);jiant.DEBUG_MODE.events&&!m[k]&&(m[k]=1);c._innerData.trigger(k,[c,a,f]);c!=b&&b._innerData.trigger(k,[c,a,f]);e||(u("fire event: "+l),jiant.DEBUG_MODE.events&&!m[l]&&(m[l]=1),p.trigger(l,[c,g,a,f]))}else c._sourceObjectData[g]=a;return c._sourceObjectData[g]},H(c,k,g)})}function X(a){return(""+a).indexOf("{}")==(""+a).length-2}function Da(a,
b){f.each(a,function(a,d){jiant.logInfo("implementing model "+a);ga(a,d,d,b)})}function Ea(a,b){f.each(a,function(a,d){jiant.logInfo("binding logic "+a);f.isFunction(d)?X(d)&&jiant.logError("don't declare empty logic functions, use objects for namespace grouping"):(f.each(d,function(b,g){X(g)&&(d[b]=function(){jiant.logError("Logic function app.logics."+a+"."+b+" called before implemented!")})}),d.implement=function(e){f.each(d,function(a,b){"implement"!=a&&(e[a]?d[a]=e[a]:jiant.logError("Logic function "+
a+" is not implemented by declared implementation"))});ha(b,a);!y[b]&&(y[b]={});y[b][a]=1;ia(b)})})}function ia(a){var b=0;f.each(s[a],function(){b++});jiant.logInfo("implementation assigned to "+name+", remaining unbound logics count: "+b+(0==b?", all logics loaded OK!":""))}function Fa(a,b){var c=ja[b];c&&s[a][b]&&(t[a].logic||(t[a].logic={}),t[a].logic[b]||(t[a].logic[b]={}),f.each(c,function(c,e){t[a].logic[b][c]=e}),ha(a,b),y[a][b]=1,ia(a))}function ha(a,b){var c=s[a][b];delete s[a][b];c&&f.each(c,
function(c,e){p.trigger(a+"jiant_dependency_resolved_"+b)})}function Ga(a,b){f.each(a,function(c,d){C("binding event: "+c);a[c].listenersCount=0;a[c].fire=function(){u("fire event: "+c);jiant.DEBUG_MODE.events&&!m[c]&&(m[c]=1);p.trigger(b+c+".event",arguments)};a[c].on=function(d){var g;jiant.DEBUG_MODE.events&&(q("assigning event handler to: "+c),m[c]&&q(" !!! Event handler assigned after fire occured, possible error, for event "+c),g=D());a[c].listenersCount++;p.on(b+c+".event",function(){u("called event handler: "+
c+", registered at "+g);var a=f.makeArray(arguments);a.splice(0,1);d&&d.apply(d,a)})}})}function Ha(a,b,c){f(window).hashchange?(f.each(a,function(a,e){C("binding state: "+c+a);e.go=Ia(a,e.root,b,c);e.start=function(b){var e;jiant.DEBUG_MODE.states&&(q("register state start handler: "+c+a),N[c+a]&&q(" !!! State start handler registered after state triggered, possible error, for state "+c+a),e=D());p.on(c+"state_"+a+"_start",function(){L("called state start handler: "+c+a+", registered at "+e);var k=
f.makeArray(arguments);k.splice(0,1);b&&b.apply(b,k)});var k=I(c);t[c]&&(""==a&&0==k.now.length||k.now[0]==a)&&(k=k.now,k.splice(0,1),b&&b.apply(b,k))};e.end=function(b){var e;jiant.DEBUG_MODE.states&&(q("register state end handler: "+c+a),N[c+a]&&q(" !!! State end handler registered after state triggered, possible error, for state "+a),e=D());p.on(c+"state_"+a+"_end",function(){L("called state end handler: "+c+a+", registered at "+e);var k=f.makeArray(arguments);k.splice(0,1);b&&b.apply(b,k)})}}),
f(window).hashchange(Ja(c)),z[c]=I(c).now[0],Y[c]=O(c)):(jiant.logError("No hashchange plugin and states configured. Don't use states or add hashchange plugin (supplied with jiant)"),jiant.DEV_MODE&&alert("No hashchange plugin and states configured. Don't use states or add hashchange plugin (supplied with jiant)"))}function Ja(a){return function(b,c,d){if(!d||d==a){location.hash.substring(1);b=I(a);d=b.now[0];var e=b.now;if(c||Y[a]!=O(a))e.splice(0,1),f.each(e,function(a,b){"undefined"==b&&(e[a]=
void 0)}),void 0!=z[a]&&z[a]!=d&&(L("trigger state end: "+a+(z[a]?z[a]:"")),p.trigger(a+"state_"+z[a]+"_end")),z[a]=d,Y[a]=O(a),d=d?d:"",L("trigger state start: "+a+d),jiant.DEBUG_MODE.states&&!N[a+d]&&(N[a+d]=1),p.trigger(a+"state_"+d+"_start",e)}}}function Ia(a,b,c,d){return function(){var e=I(d),g=e.now;e.now=[a];x("Going to state "+a+" with data",arguments);f.each(arguments,function(b,c){void 0!=c?e.now.push(v(c)):g[0]!=a&&!ka(d,g[0],a)||void 0==g[b+1]?e.now.push(v(c)):(S("reusing pref param: "+
g[b+1]),e.now.push(v(g[b+1])))});if(g&&(g[0]==a||ka(d,g[0],a)))for(var h=arguments.length;h<g.length-1;)S("pushing prevState param: "+g[h]),e.now.push(v(g[++h]));b?(e.root=[],f.each(e.now,function(a,b){e.root.push(b)})):f.each(e.root,function(a,b){e.root[a]=v(b)});la(e,c,d)}}function ka(a,b,c){a=t[a].states;return void 0!==a[b].statesGroup&&a[b].statesGroup===a[c].statesGroup}function la(a,b,c){var d=P(),e="",g=a.now+"|"+a.root;f.each(d,function(a,b){e=c==a?e+(a+"="+g+"="):e+(a+"="+b+"=")});d[c]||
(e+=c+"="+g+"=");a=b||""==b?b:jiant.STATE_EXTERNAL_BASE;window.location.assign((a?a:"")+"#"+e);f(window).hashchange()}function P(){var a=location.hash.substring(1).split("="),b={};f.each(a,function(c,d){0==c%2&&d&&void 0!=a[c+1]&&(b[d]=a[c+1])});return b}function O(a){if(a)return a=P()[a],void 0==a?"":a;var b="";f.each(P(),function(a,d){b=d;return!1});return b}function I(a){a=O(a).split("|");var b={now:[],root:[]};f.each(a,function(a,d){var e=d.split(",");f.each(e,function(d,e){b[0==a?"now":"root"].push(Z(e))})});
b.now=b.now||[];b.root=b.root||[];return b}function v(a){if(f.isPlainObject(a)){var b="{";f.each(a,function(a,d){b+=v(a);b+=":";b+=v(d);b+="}"});b="}"==b[b.length-1]?b.substring(0,b.length-1):b;return v(b)}return(a+="")?a.replace(Ka,function(a){return ma[a]}):""}function Z(a){if((a=a?a.replace(La,function(a){return na[a]}):"")&&"{"==a[0]){var b={};a=a.substring(1,a.length).split("}");f.each(a,function(a,d){var e=d.split(":");2==e.length&&(b[Z(e[0])]=Z(e[1]))});return b}return a}function Ma(a,b,c,
d){f.each(a,function(e,g){C("binding ajax for function: "+e);var h;h=g.toString();(h=h.slice(h.indexOf("(")+1,h.indexOf(")")).match(/([^\s,]+)/g))&&0<h.length?h.splice(h.length-1,1):h=[];a[e]=Na(b,c,e,h,f.isFunction(a[e])?a[e]():void 0,d);a[e]._jiantSpec=h})}function oa(a,b,c){f.isArray(c)?a[b]=c:f.isPlainObject(c)?f.each(c,function(b,c){oa(a,b,c)}):a[b]=c}function Na(a,b,c,d,e,g){return function(){var h={},k,l,n=arguments;f.isFunction(n[n.length-2])?(k=n[n.length-2],l=n[n.length-1]):f.isFunction(n[n.length-
1])&&(k=n[n.length-1]);f.each(d,function(a,b){a<n.length&&!f.isFunction(n[a])&&void 0!=n[a]&&null!=n[a]&&oa(h,b,n[a])});h.antiCache3721||(h.antiCache3721=(new Date).getTime());var m=a||""==a?a:jiant.AJAX_PREFIX,p=b||""==b?b:jiant.AJAX_SUFFIX,m=e?e:m+c+p;C("    AJAX call. "+c+" to server url: "+m);p={data:h,traditional:!0,success:function(a){if(k){try{a=f.parseJSON(a)}catch(b){}jiant.DEBUG_MODE.ajax&&q("   ---   Ajax call results for uri "+c)&&q(a);k(a)}},error:function(a,b,c){l?l(a.responseText):
jiant.handleErrorFn(a.responseText)}};g&&(p.contentType="application/json",p.dataType="jsonp",p.xhrFields={withCredentials:!0},p.crossDomain=!0);f.ajax(m,p)}}function A(a,b,c){if(a[b])return!0;if(a[c])return a[b]=a[c],!0;a[b]={};return!1}function pa(a,b,c,d){jiant.DEV_MODE=c;!c&&0<=(window.location+"").toLowerCase().indexOf("jiant.dev_mode")&&(jiant.DEV_MODE=!0);0<=(window.location+"").toLowerCase().indexOf("jiant.debug_events")&&(jiant.DEBUG_MODE.events=1);0<=(window.location+"").toLowerCase().indexOf("jiant.debug_states")&&
(jiant.DEBUG_MODE.states=1);0<=(window.location+"").toLowerCase().indexOf("jiant.debug_ajax")&&(jiant.DEBUG_MODE.ajax=1);0<=(window.location+"").toLowerCase().indexOf("jiant.debug_data")&&(jiant.DEBUG_MODE.data=1);K="";V=!0;var e=b.id?b.id:"no_app_id";b.id?jiant.logInfo("Loading application, id: "+b.id):jiant.logError("!!! Application id not specified. Not recommended since 0.20. Use 'id' property of application root to specify application id");t[e]?jiant.logError("Application '"+e+"' already loaded, skipping multiple bind call"):
(A(b,"views","v")&&za(a,b.views,b,d),A(b,"templates","t")&&Ba(a,b.templates,b,d),A(b,"ajax","a")&&Ma(b.ajax,b.ajaxPrefix,b.ajaxSuffix,b.crossDomain),A(b,"events","e")&&Ga(b.events,e),A(b,"states","s")&&Ha(b.states,b.stateExternalBase,e),A(b,"models","m")&&Da(b.models,e),A(b,"logic","l")&&Ea(b.logic,e),jiant.DEV_MODE&&!V&&alert("Some elements not bound to HTML properly, check console"+K),t[e]=b,jiant.logInfo(b),p.trigger(e+"onAppInit"+e),f.when.apply(f,qa).done(function(){p.trigger(e+"jiant_uiBound_"+
e)}))}function Oa(a){return f.isPlainObject(a)?a.id:a}function aa(a,b){var c=!0;f.each(a,function(d,e){if(!t[e])return p.one(e+"jiant_uiBound_"+e,function(){aa(a,b)}),c=!1});if(c){var d=!0,e=[f];f.each(a,function(c,h){f.each(s[h],function(c,e){d=d&&0>f.inArray(b,e);!d&&p.one(h+"jiant_dependency_resolved_"+c,function(){aa(a,b)});return d});if(!d)return!1;e.push(t[h])});d&&b.apply(b,e)}}var da={},V=!0,K,z={},Y={},y={},s={},ja={},p=f({}),t={},qa=[],T=new ra,N={},m={},ma={";":";;",",":";1","=":";2","|":";3",
"{":";4","}":";5",":":";6","#":";7","'":";7"},na={},Ka=/;|,|=|\||\{|\}|:|#/gi,La=/;;|;1|;2|;3|;4|;5|;6|;7/gi;f.each(ma,function(a,b){na[b]=a});return{AJAX_PREFIX:"",AJAX_SUFFIX:"",DEV_MODE:!1,DEBUG_MODE:{states:0,events:0,ajax:0,data:0},PAGER_RADIUS:6,isMSIE:eval("/*@cc_on!@*/!1"),STATE_EXTERNAL_BASE:void 0,getAwaitingDepends:function(){return s},bind:function(a,b){f.extend(a,b)},bindUi:function(a,b,c,d,e){var g=(new Date).getTime();f.isPlainObject(a)&&(e=d,d=c,c=b,b=a,a=b.appPrefix);var h=b.uiFactory?
b.uiFactory:T;if(d){var k;e?(k=f("#"+e),k[0]||(k=f("<div id='"+e+"' style='display:none'></div>"),f("body").append(k))):k=f("body");k.load(d,{},function(){pa(a,b,c,h)})}else pa(a,b,c,h);jiant.logInfo("UI bound in "+((new Date).getTime()-g)+"ms");c&&setTimeout(function(){0<s.length&&J("Attention!! Some depends are not resolved",s)},1E4)},declare:function(a,b){ja[a]=b;f.each(s,function(b,d){Fa(b,a)})},goRoot:function(a){function b(a){var b=I(a);b.now=[];f.each(b.root,function(a,c){b.now.push(v(c));
b.root[a]=v(c)});la(b,void 0,a)}a&&b(a);!a&&f.each(P(),function(a,d){b(a)})},goState:function(a,b){},onUiBound:function(a,b,c){c||b?c||(c=b,b=[]):(jiant.logError("!!! Registering anonymous logic without application id. Not recommended since 0.20"),c=a,a=["no_app_id"]);f.isArray(a)||(a=[a]);1<a.length&&f.isArray(b)&&0<b.length?f.each(b,function(a,b){f.isArray(b)||jiant.logError("Used multiple applications onUiBound and supplied wrong dependency list, use multi-array, like [[app1DepList], [app2DepList]]")}):
1==a.length&&b.length&&(b=[b]);f.each(a,function(d,e){f.isPlainObject(e)&&(e=e.id,a[d]=e);!s[e]&&(s[e]={});!y[e]&&(y[e]={});b[d]&&f.each(b[d],function(a,b){!s[e][b]&&(s[e][b]=[]);!y[e][b]&&s[e][b].push(c)})});aa(a,c)},onAppInit:function(a,b){var c=new f.Deferred;qa.push(c.promise());var d=function(){c.resolve()};if(t[a])jiant.logError("Defining and calling onUiBound() before onAppInit().");else p.on(a+"onAppInit"+a,function(){b&&b(f,t[a],d)})},refreshState:function(a){f(window).hashchange&&f(window).trigger("hashchange",
[!0,Oa(a)])},getCurrentState:function(a){a=I(a);return a.now[0]?a.now[0]:""},setUiFactory:function(a){var b=!0;f.each(["template","viewComponent","view"],function(c,d){a[d]||(jiant.logError("UI Factory doesn't implement method "+d+", ignoring bad factory"),b=!1)});b&&(T=a)},visualize:function(a){f("id")[0]||(f("body").append('<div style="border: 1px solid green; width: 100%; height: 100%; position: absolute; left: 0; top: 0"><canvas id="jiant_gr_vis" width="'+f(window).width()+'" height="'+f(window).height()+
'"></canvas></div>'),a||f.each(t,function(b,c){a=b;return!1}),f("head").append('<script type="text/javascript" src="https://raw.github.com/vecnas/jiant/master/graph.js"> \x3c/script>'),jiant.onUiBound(a,["jiantVisualizer"],function(a,c){c.logic.jiantVisualizer.visualize(a,c)}))},handleErrorFn:function(a){J(a)},logInfo:C,logError:J,info:S,error:function(){var a="";f.each(arguments,function(b,c){a+=c;a+=" "});J(a)},parseTemplate:function(a,b){return f(B(a,b))},parseTemplate2Text:function(a,b){return B(a,
b)},version:function(){return 103},formatDate:function(a){a=w(a);return null==a?"":r(a.getFullYear())+"-"+r(a.getMonth()+1)+"-"+r(a.getDate())},formatDateUsa:function(a){a=w(a);return null==a?"":r(a.getMonth()+1)+"/"+r(a.getDate())+"/"+r(a.getFullYear())},formatMoney:function(a,b){b=void 0!==b?b:",";var c=parseInt(a);if(isNaN(c))return"";if(0==c)return"0";for(var d=""+Math.abs(c),e=d.length;0<e;e-=3)d=d.substring(0,e)+(e<d.length?b:"")+d.substring(e);return(0>c?"-":"")+d},formatTime:function(a){a=
w(a);return null==a?"":r(a.getHours())+":"+r(a.getMinutes())},formatTimeSeconds:function(a){a=w(a);return null==a?"":r(a.getHours())+":"+r(a.getMinutes())+":"+r(a.getSeconds())},randomIntBetween:function(a,b){return Math.floor(Math.random()*(b-a+1)+a)},lfill:r,collection:{},container:{},containerPaged:da,ctl:{},fn:function(a){},form:{},grid:{},image:{},input:{},inputDate:{},inputInt:{},inputFloat:{},label:{},meta:{},lookup:function(a){},on:function(a){},pager:{},slider:{},stub:function(){var a="not available";
arguments&&arguments.callee&&arguments.callee.caller&&(a=arguments.callee.caller.name);alert("stub called from function: "+a)},tabs:{},key:{left:37,up:38,right:39,down:40,del:46,backspace:8,tab:9,end:35,home:36,enter:13,ctrl:17,escape:27,dot:190,dotExtra:110,comma:188,a:65,c:67,u:85,w:87,space:32,1:49,2:50,3:51,4:52,5:53,6:54}}}(jQuery);window.jiant&&window.jiant.version&&window.jiant.version()>=Q.version()||(window.jiant=Q)})();
