(function(){var Ea=function(){return{template:function(f,y,t){return $("#"+f+y)},viewComponent:function(f,y,t,N,B){return f.find("."+t+N)},view:function(f,y){return $("#"+f+y)}}},M=function(f){function y(a){var b=Number(a);return 0===b&&0!==a&&"0"!==a||isNaN(b)?null:new Date(b)}function t(a){a=""+a;return 0==a.length?"00":1==a.length?"0"+a:a}function N(a){f.each(a.find("*"),function(a,c){f.each(c.attributes,function(a,b){0>b.value.indexOf(" ")&&0<=b.value.indexOf("!!")&&f(c).attr(b.name,b.value.replace(/!!/g,
"e2013e03e11eee "))})});return f.trim(f(a).html()).replace(/!!/g,"!! ").replace(/e2013e03e11eee /g,"!! ")}function B(a,b,c){b=b||{};c=f.trim(f(a).html());var e={},d="";c=jiant.isMSIE?N(f(a)):c.replace(/!!/g,"!! ");try{var h=e[c];if(!h){var g="var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+c.replace(/[\r\t\n]/g," ").replace(/'(?=[^#]*#>)/g,"\t").split("'").join("\\'").split("\t").join("'").replace(/!! (.+?)!! /g,"',$1,'").split("!?").join("');").split("?!").join("p.push('")+
"');}return p.join('');",h=new Function("obj",g);e[c]=h}return f.trim(h(b))}catch(k){d=k.message,C("Error parse template: "+d)}return"!!! ERROR: "+d.toString()+" !!!"}function w(a,b,c){a=isNaN(b)?a:parseFloat(a)<b?b:a;a=isNaN(c)?a:parseFloat(a)>c?c:a;return""+a}function M(a){a.keydown(function(b){if(b.keyCode==jiant.key.down&&0<a.val())return a.val(w(a.valInt()-1,a.j_valMin,a.j_valMax)),a.trigger("change"),!1;if(b.keyCode==jiant.key.up)return a.val(w(a.valInt()+1,a.j_valMin,a.j_valMax)),a.trigger("change"),
!1;if(b.keyCode!=jiant.key.backspace&&b.keyCode!=jiant.key.del&&b.keyCode!=jiant.key.end&&b.keyCode!=jiant.key.left&&b.keyCode!=jiant.key.right&&b.keyCode!=jiant.key.home&&b.keyCode!=jiant.key.tab&&b.keyCode!=jiant.key.enter&&(b.shiftKey||(48>b.keyCode||57<b.keyCode)&&(96>b.keyCode||105<b.keyCode)))return b.preventDefault(),!1;a.val(w(a.valInt(),a.j_valMin,a.j_valMax));return!0});a.change(function(b){a.val(w(a.valInt(),a.j_valMin,a.j_valMax));return!1});a.valInt=function(){var b=parseInt(a.val());
return isNaN(b)?0:b};a.setMax=function(b){a.j_valMax=b;a.attr("max",b);a.val(w(a.valInt(),a.j_valMin,a.j_valMax))};a.setMin=function(b){a.j_valMin=b;a.attr("min",b);a.val(w(a.valInt(),a.j_valMin,a.j_valMax))}}function Fa(a){a.keydown(function(b){if(b.keyCode==jiant.key.down&&0<a.val())return a.val(w(a.valFloat()-1,a.j_valMin,a.j_valMax)),a.trigger("change"),!1;if(b.keyCode==jiant.key.up)return a.val(w(a.valFloat()+1,a.j_valMin,a.j_valMax)),a.trigger("change"),!1;if(b.keyCode==jiant.key.dot||b.keyCode==
jiant.key.dotExtra)return 0>a.val().indexOf(".")&&0<a.val().length;if(b.keyCode==jiant.key.backspace||b.keyCode==jiant.key.del||b.keyCode==jiant.key.end||b.keyCode==jiant.key.left||b.keyCode==jiant.key.right||b.keyCode==jiant.key.home||b.keyCode==jiant.key.tab||b.keyCode==jiant.key.enter)a.val(w(a.valFloat(),a.j_valMin,a.j_valMax));else{if(b.shiftKey||(48>b.keyCode||57<b.keyCode)&&(96>b.keyCode||105<b.keyCode))return b.preventDefault(),!1;a.val(w(a.val(),a.j_valMin,a.j_valMax))}return!0});a.valFloat=
function(){var b=parseFloat(a.val());return isNaN(b)?0:b};a.setMax=function(b){a.j_valMax=b;a.attr("max",b);a.val(w(a.valFloat(),a.j_valMin,a.j_valMax))};a.setMin=function(b){a.j_valMin=b;a.attr("min",b);a.val(w(a.valFloat(),a.j_valMin,a.j_valMax))}}function Ga(a,b,c,e){if(b[0]){var d=b[0].tagName.toLowerCase();"form"!=d&&(jiant.logError(c+"."+e+" form element assigned to non-form: "+d),jiant.DEV_MODE&&alert(c+"."+e+" form element assigned to non-form: "+d));b.submitForm=function(d,g){d=d?d:b.attr("action");
d=(a.ajaxPrefix?a.ajaxPrefix:jiant.AJAX_PREFIX?jiant.AJAX_PREFIX:"")+d;d+=a.ajaxSuffix?a.ajaxSuffix:jiant.AJAX_SUFFIX?jiant.AJAX_SUFFIX:"";var k={type:"POST",url:d,data:b.serialize(),success:g};a.crossDomain&&(k.contentType="application/json",k.dataType="jsonp",k.xhrFields={withCredentials:!0},k.crossDomain=!0);f.each(n,function(b,d){d.submittingForm&&d.submittingForm(a,c,e,k)});return f.ajax(k)}}}function ea(a,b){var c=b[0]+"";f.each(b,function(a,b){if(0<a){var f=c.indexOf("!!");0<=f?c=c.substring(0,
f)+b+c.substring(f+2):(c+=" ",c+=b)}});a(c)}function fa(a,b){var c="";f.each(b,function(a,b){c+=b;c+=" "});a(c)}function ga(a,b){window.console&&window.console[a]&&f.each(b,function(b,e){window.console[a](e)})}function C(){ga("error",arguments)}function O(a){jiant.DEV_MODE&&ga("info",arguments)}function P(){fa(C,arguments)}function ha(){fa(O,arguments)}function Ha(a){function b(b,c){var k=f(B(f("<b><li class='!!ctlClass!!' style='cursor: pointer;'><a>!!label!!</a></li></b>"),{label:-1!=b?b:"...",
ctlClass:c}));e.append(k);-1!=b&&k.click(function(){d=b;a.refreshPage()});return k}var c=f({}),e=f("<ul></ul>"),d=0;e.addClass("pagination");a.append(e);a.onValueChange=function(a){c.on("ValueChange",a)};a.refreshPage=function(){c.trigger("ValueChange",d)};a.updatePager=function(a){e.empty();var c=Math.max(0,a.number-jiant.PAGER_RADIUS/2),d=Math.min(a.number+jiant.PAGER_RADIUS/2,a.totalPages);0<c&&(b(1,""),b(-1,"disabled emptyPlaceholder"));for(;c<d;c++){var f="";c==a.number&&(f+=" active");b(c+1,
f)}d<a.totalPages-1&&b(-1,"disabled emptyPlaceholder");d<a.totalPages&&b(a.totalPages,"")}}function Ia(a){function b(){g=Math.max(g,0);g=Math.min(g,d.children().length-1);c.css("visibility",0<g?"visible":"hidden");e.css("visibility",g<d.children().length-h?"visible":"hidden");f.each(d.children(),function(a,b){var c=f(b);a>=g&&a<g+h?c.show():c.hide()})}var c=f("<div>&laquo;</div>"),e=f("<div>&raquo;</div>"),d=f("<div></div>"),h=8,g=0;c.addClass("paged-prev");e.addClass("paged-next");d.addClass("paged-container");
a.empty();a.append(c);a.append(d);a.append(e);c.click(function(){g-=h;b()});e.click(function(){g+=h;b()});a.append=function(a){d.append(a);b()};a.empty=function(){d.empty();b()};a.setHorizontal=function(a){a=a?"inline-block":"block";c.css("display",a);e.css("display",a);d.css("display",a)};a.setPageSize=function(a){h=a;b()};a.setHorizontal(!0)}function Q(){var a={stack:{}};Error.captureStackTrace&&Error.captureStackTrace(a,Q);return a.stack}function Ja(a,b,c,e,d,h){var g={};f.each(e,function(e,f){g[e]=
e;if("appPrefix"!=e)if(b[e]===jiant.lookup)jiant.logInfo("    loookup element, no checks/bindings: "+e),b[e]=function(){return d.find("."+h+e)};else if(b[e]!==jiant.meta)if(b[e]===jiant.data)b[e]=function(a){return 0==arguments.length?b.attr("data-"+e):b.attr("data-"+e,a)},b[e].customRenderer=function(a,c,d,g,f){b[e](d)};else if(b[e]===jiant.cssMarker||b[e]===jiant.cssFlag){var z=b[e]===jiant.cssFlag,l="j_prevMarkerClass_"+e;b[e]={};b[e].customRenderer=function(a,b,c,d,g){a=e+(z?"":"_"+c);g[l]&&g.removeClass(g[l]);
if(!z&&void 0!==c||z&&c)g[l]=a,g.addClass(a)}}else{var q=b[e]===ia,u=R.viewComponent(d,c,h,e,f);I(h,a.dirtyList,u,h+c,h+e);b[e]=u;q&&ja(a,b[e]);ka(a,u,f,c,e)}});b._jiantSpec=g}function Ka(a,b){f.each(a,function(a,e){b[a]&&(jiant.logError("unsafe extension: "+a+" already defined in base jQuery, shouldn't be used, now overriding!"),b[a]=void 0)})}function la(a){var b=typeof a;if("object"!=b||null===a)return"string"==b&&(a='"'+a+'"'),String(a);var c=[],e=a&&a.constructor==Array;f.each(a,function(a,f){b=
typeof f;"string"==b?f='"'+f+'"':"object"==b&&null!==f&&(f=la(f));c.push((e?"":'"'+a+'":')+(f?f:'""'))});return(e?"[":"{")+String(c)+(e?"]":"}")}function S(a,b,c){jiant.DEV_MODE&&a.click(function(e){if(e.shiftKey&&e.altKey){var d=b+(c?"."+c:"");e.ctrlKey&&(d=d+"\r\n------------\r\n"+la(f._data(a[0],"events")));jiant.logInfo(d);alert(d);e.preventDefault();e.stopImmediatePropagation()}})}function I(a,b,c,e,d){return e&&b&&(0<=f.inArray(e,b)||a&&0<=f.inArray(e.substring(a.length),b))?!0:c&&c.length?
!0:(window.console&&window.console.error&&(d?jiant.logError("non existing object referred by class under object id '"+e+"', check stack trace for details, expected obj class: "+d):jiant.logError("non existing object referred by id, check stack trace for details, expected obj id: "+e)),H=d?H+("   ,    #"+e+" ."+d):H+(", #"+e),T=!1)}function La(a){a.reload=function(a){a=a||this.attr("src");a=-1<a.indexOf("?")?a:a+"?";var c="&_="+(new Date).getTime();a=-1<a.indexOf("&_=")?a.replace(/&_=[0-9]{13}/,c):
a+c;this.attr("src",a)}}function ka(a,b,c,e,d){(c==jiant.tabs||c.tabsTmInner)&&b.tabs?(b.tabs(),b.refreshTabs=function(){b.tabs("refresh")}):c==jiant.inputInt||c.inputIntTmInner?M(b):c==jiant.inputFloat||c.inputFloatTmInner?Fa(b):(c==jiant.inputDate||c.inputDateTmInner)&&b.datepicker?b.datepicker():c==jiant.pager||c.pagerTmInner?Ha(b):c==jiant.form||c.formTmInner?Ga(a,b,e,d):c==ma||c.containerPagedTmInner?Ia(b):c==jiant.image||c.imageTmInner?La(b):(c==jiant.nlabel||c.nlabelTmInner)&&ja(a,b);S(b,e,
d)}function na(a,b,c,e){var d={};f.each(b,function(a,b){d[a]=b});var h=function(a,k,m){k=void 0===k?!0:k;f.each(d,function(d,l){if(b[d].customRenderer||a&&void 0!==a[d]&&null!==a[d]&&!(0<=f.inArray(d,["parseTemplate","parseTemplate2Text","propagate","customRenderer"]))){var q=a[d];l=c[d];if(f.isFunction(q)){if(U(b[d])(a,l,q.apply(a),!1,e),k&&f.isFunction(q.on)){if(h[d]){var u=h[d][0];u&&u(h[d][1]);h[d][2]&&l.off("change",h[d][2])}u=q.on(function(c,f){U(b[d])(a,l,f,!0,e)});h[d]=[q.off,u]}}else U(b[d])(a,
l,q,!1,e);m&&(u=function(a){a=l[0].tagName.toLowerCase();var b=l.attr("type");"input"==a&&"checkbox"==b?q(!!l.prop("checked")):q(l.val())},l.change&&l.val&&l.change(u),h[d]&&h[d].push(u))}});b.customRenderer&&f.isFunction(b.customRenderer)&&b.customRenderer(a,c)};return h}function U(a){return a&&a.customRenderer&&f.isFunction(a.customRenderer)?a.customRenderer:Ma}function Ma(a,b,c,e,d){b&&b[0]&&(a=["text","hidden",void 0],e=b[0].tagName.toLowerCase(),"input"==e||"textarea"==e||"select"==e?(e=f(b[0]).attr("type"),
0<=f.inArray(e,a)?void 0!==c&&b.val(c+""):"checkbox"==e?b.prop("checked",!!c):"radio"==e&&f.each(b,function(a,b){f(b).prop("checked",b.value==c)})):"img"==e?b.attr("src",c):b.html(c))}function Na(a,b,c,e){f.each(b,function(d,h){var g=h.appPrefix?h.appPrefix:c?c:"",k=e.view(g,d);I(g,a.dirtyList,k,g+d)&&Ja(a,b[d],d,h,k,g);Ka(b[d],k);b[d].propagate=na(d,h,h,b[d]);f.extend(b[d],k);S(k,d,void 0);f.each(n,function(c,e){e.boundView&&e.boundView(a,b,d,g,b[d])})})}function Oa(a){switch(a){case jiant.label:return"labelTmInner";
case jiant.nlabel:return"nlabelTmInner";case jiant.ctl:return"ctlTmInner";case jiant.container:return"containerTmInner";case jiant.containerPaged:return"containerPagedTmInner";case jiant.form:return"formTmInner";case jiant.pager:return"pagerTmInner";case jiant.image:return"imageTmInner";case jiant.grid:return"gridTmInner";case jiant.input:return"inputTmInner";case jiant.inputInt:return"inputIntTmInner";case jiant.inputFloat:return"inputFloatTmInner";case jiant.inputDate:return"inputDateTmInner";default:return"customTmInner"}}
function Pa(a,b,c,e){f.each(b,function(d,h){var g=h.appPrefix?h.appPrefix:c?c:"",k=e.template(g,d,h);f.each(h,function(b,c){if("appPrefix"!=b)if(c===jiant.lookup)jiant.logInfo("    loookup element, no checks/bindings: "+b),h[b]=function(){return h.find("."+g+b)};else if(c!==jiant.meta)if(c===jiant.data)h[b].customRenderer=function(a,c,d,e,f){f[b](d)};else if(c===jiant.cssMarker||c===jiant.cssFlag){h[b]={};var f=c===jiant.cssFlag,q="j_prevMarkerClass_"+b;h[b].customRenderer=function(a,c,d,e,g){a=b+
(f?"":"_"+d);g[q]&&g.removeClass(g[q]);if(!f&&void 0!==d||f&&d)g[q]=a,g.addClass(a)}}else{var u=e.viewComponent(k,d,g,b,c);I(g,a.dirtyList,u,g+d,g+b);u=Oa(h[b]);h[b]={};h[b][u]=!0}});I(g,a.dirtyList,k,g+d);b[d].parseTemplate=function(c){var e=f("\x3c!-- --\x3e"+B(k,c,d));f.each(h,function(c,h){h===jiant.data?e[c]=function(a){return 0==arguments.length?e.attr("data-"+c):e.attr("data-"+c,a)}:"parseTemplate"!=c&&"parseTemplate2Text"!=c&&"appPrefix"!=c&&(e[c]=f.merge(e.filter("."+g+c),e.find("."+g+c)),
ka(a,e[c],b[d][c],d,c),S(e[c],d,c))});e.splice(0,1);e.propagate=na(d,h,e,e);c&&e.propagate(c);e._jiantSpec=b[d];f.each(n,function(f,g){g.parsedTemplate&&g.parsedTemplate(a,b,d,b[d],c,e)});return e};b[d].parseTemplate2Text=function(a){return B(k,a)};f.each(n,function(c,e){e.boundTemplate&&e.boundTemplate(a,b,d,g,b[d])})})}function Qa(a,b,c){a[c].asap=function(e){var d=a[c]();if(void 0!=d)e&&e.apply(e,[a,d]);else a.jiant_innerData.one(b,function(){var a=f.makeArray(arguments);a.splice(0,1);e&&e.apply(e,
a)})}}function D(a,b,c,e){e=e?e:a.jiant_innerData;var d=function(d){var h=function(){var a=f.makeArray(arguments);a.splice(0,1);d&&d.apply(d,a)};(c?a[c]:a).listenersCount++;e.on(b,h);return h},h=function(d){(c?a[c]:a).listenersCount--;e.off(b,d)};c?(a[c].on=d,a[c].off=h,a[c].listenersCount=0,Qa(a,b,c)):(a.on=d,a.off=h,a.listenersCount=0)}function oa(a,b,c,e){var d=[],h=[];c._modelData={};b.updateAll&&b.id&&(b.update||(b.update=function(a){}),b.findById||(b.findById=function(a){}));b.updateAll&&(b.add||
(b.add=function(a){}),b.remove||(b.remove=function(a){}));b.update||f.each(b,function(a,c){if(0==a.indexOf("set")&&3<a.length&&(""+c).indexOf("{}")==(""+c).length-2)return b.update=function(a){},!1});b.asMap||(b.asMap=function(){});c.jiant_innerData=f({});f.each(b,function(g,k){var m=a+"_"+g+"_event",z=e+a+"_globalevent";if("jiant_innerData"!=g)if("all"==g)c[g]=function(){var a=[];f.each(d,function(b,c){a.push(c)});pa(a,h);return a};else if("on"==g)h.push(g),D(c,z,void 0,s);else if("update"==g)h.push(g),
c[g]=function(a,d){var e=!1,h={};c._sourceData=a;d&&f.each(c._modelData,function(b,c){void 0==a[b]&&(a[b]=null)});f.each(a,function(a,b){c[a]&&f.isFunction(c[a])&&c[a]()!=b&&(c[a](b,!1),e=h[a]=!0)});f.each(h,function(a,b){c[a](c[a](),!0,!0)});e&&(c.jiant_innerData.trigger(m,c),c!=b&&b.jiant_innerData.trigger(m,c),s.trigger(z,[c,g]))},D(c,m,g);else if("updateAll"==g)c[g]=function(a,b,e){a=f.isArray(a)?a:[a];e=e?e:function(a,b){return a.id?a.id()==b.id:!1};var g=[],h=[];f.each(a,function(a,b){h.push(b)});
f.each(d,function(c,d){var k;f.each(a,function(a,b){return e(d,b)?(k=b,!1):!0});var m=h.indexOf(k);b&&!k&&g.push(d);k&&0<=c&&h.splice(m,1);k&&d.update(k)});b&&f.each(g,function(a,b){c.remove(b)});0<h.length&&c.add(h)},D(c,m,g);else if("addAll"==g)alert("JIANT: Model function 'addAll' removed since 1.37, use previous versions or replace it by 'add'");else if("add"==g)c[g]=function(h){function k(g){var h={},m={};d.push(h);l.push(h);h._sourceData=g;h._parentModel=c;oa(a,b,h,e);f.each(g,function(a,b){h[a]&&
(h[a](b,!1),m[a]=b)});f.each(m,function(a,b){h[a](h[a](),!0,!0)})}if(void 0!=h&&null!=h&&(h=f.isArray(h)?h:[h],0!=h.length)){var l=[];f.each(h,function(a,b){k(b)});c.jiant_innerData.trigger(m,[l]);s.trigger(z,[l,g]);f.each(h,function(a,b){l[a].update&&l[a].update(b)});return l}},D(c,m,g);else if("remove"==g)h.push(g),c[g]=function(a){if(void 0==a||null==a)c._parentModel.remove(c);else{var b=d.length;d=f.grep(d,function(b){return b!=a});d.length!=b&&(c.jiant_innerData.trigger(m,[a]),s.trigger(z,[a,
g]));return a}},D(c,m,g);else if(0==g.indexOf("findBy")&&6<g.length){var l=g.substring(6).split("And");c[g]=function(){function a(b,c,d){return f.grep(b,function(a){return void 0==d||a[c]()==d})}var b=d,c=arguments;f.each(l,function(d,e){var f=e.substring(0,1).toLowerCase()+e.substring(1);b=a(b,f,c[d])});return b[0]}}else 0==g.indexOf("listBy")&&6<g.length?(l=g.substring(6).split("And"),c[g]=function(){function a(b,c,d){return f.grep(b,function(a){return void 0==d||a[c]()==d})}var b=d,c=arguments;
f.each(l,function(d,e){var f=e.substring(0,1).toLowerCase()+e.substring(1);b=a(b,f,c[d])});pa(b,h);return b}):0==g.indexOf("set")&&3<g.length?(h.push(g),l=g.substring(3).split("And"),c[g]=function(){var a=arguments,b={};f.each(l,function(c,d){var e=d.substring(0,1).toLowerCase()+d.substring(1);b[e]=a[c]});c.update(b);return b}):"asMap"==g?c[g]=function(){return c._modelData}:"data"==g?c[g]=function(){return c._sourceData}:V(k)||b.jiant_innerData[g]?(h.push(g),b.jiant_innerData[g]=!0,c[g]=function(a,
d,e){if(0!=arguments.length)if(d||c._modelData[g]!==a&&!1!==d){var f=c._modelData[g];c._modelData[g]=a;c.jiant_innerData.trigger(m,[c,a,f]);c!=b&&b.jiant_innerData.trigger(m,[c,a,f]);e||s.trigger(z,[c,g,a,f])}else c._modelData[g]=a;return c._modelData[g]},c[g].jiant_accessor=1,D(c,m,g)):"_modelData"!=g&&(c[g]=k)})}function pa(a,b){f.each(b,function(b,e){a[e]=function(){var b=[],c=arguments;f.each(a,function(a,f){b.push(f[e].apply(f,c))});return b}})}function V(a){return(""+a).indexOf("{}")==(""+a).length-
2}function Ra(a,b,c){f.each(b,function(e,d){oa(e,d,d,c);f.each(n,function(c,d){d.boundModel&&d.boundModel(a,b,e,b[e])})})}function Sa(a,b,c){f.each(b,function(e,d){f.isFunction(d)?V(d)&&jiant.logError("don't declare empty logic functions, use objects for namespace grouping"):(f.each(d,function(a,b){if(f.isFunction(b)){var c=qa(b);V(b)&&(d[a]=function(){jiant.logError("Logic function app.logics."+e+"."+a+" called before implemented!")},d[a].empty=!0);d[a].params=c;d[a].spec=!0}}),d.implement=function(a){f.each(d,
function(b,c){f.isFunction(c)&&"implement"!=b&&(a[b]?d[b]=a[b]:jiant.logError("Logic function "+b+" is not implemented by declared implementation"))});W(c,e);!v[c]&&(v[c]={});v[c][e]=1;ra(c,e)},"intl"==e&&Ta(d));f.each(n,function(c,f){f.boundLogic&&f.boundLogic(a,b,e,d)})})}function ra(a,b){var c=0;f.each(r[a],function(){c++});f.each(n,function(e,d){d.logicImplemented&&d.logicImplemented(a,b,c)})}function sa(a,b,c){var e=[];f.isArray(a)||(a=[a]);f.each(a,function(a,b){var c="ext"+(new Date).getTime()+
Math.random();e.push(c);ta(c,b)});a="app"+(new Date).getTime()+Math.random();jiant.onUiBound(a,e,b);jiant.bindUi({id:a},c)}function ta(a,b){function c(){e&&jiant.info("Loaded external library "+b);E[a]=e?{}:b;f.each(r,function(b,c){X(b,a)});f.each(r,function(b,c){ua(b,a)})}var e="string"===typeof b;e&&jiant.info("Start loading external library "+b);e?f.ajax({url:b,cache:!0,crossDomain:!0,dataType:"script",success:c}):c()}function X(a,b){var c=E[b];c&&r[a][b]&&p[a]&&(p[a].logic||(p[a].logic={}),p[a].logic[b]||
(p[a].logic[b]={}),f.each(f.isFunction(c)?c(f,p[a]):c,function(c,d){p[a].logic[b][c]=d}))}function ua(a,b){E[b]&&r[a][b]&&p[a]&&(W(a,b),v[a][b]=1,ra(a,b))}function W(a,b){if(r[a]&&r[a][b]){var c=r[a][b];delete r[a][b];c&&f.each(c,function(c,d){s.trigger(a+"jiant_dependency_resolved_"+b)})}}function Ua(a,b,c){f.each(b,function(e,d){b[e].listenersCount=0;b[e].fire=function(){s.trigger(c+e+".event",arguments)};b[e].on=function(a){b[e].listenersCount++;s.on(c+e+".event",function(){var b=f.makeArray(arguments);
b.splice(0,1);a&&a.apply(a,b)})};f.each(n,function(c,d){d.boundEvent&&d.boundEvent(a,b,e,b[e])})})}function Va(a,b,c,e){f(window).hashchange?(b[""]||(b[""]={}),f.each(b,function(d,h){h.go=Wa(d,h.root,c,e);h.start=function(b){var c;f.each(n,function(b,c){c.stateStartRegisterHandler&&c.stateStartRegisterHandler(a,d,h)});J[e+d]&&f.each(n,function(b,c){c.stateError&&c.stateError(a,d,h,"State start handler registered after state triggered")});c=Q();s.on(e+"state_"+d+"_start",function(){var e=f.makeArray(arguments);
e.splice(0,1);f.each(n,function(b,f){f.stateStartCallHandler&&f.stateStartCallHandler(a,d,h,c,e)});b&&b.apply(b,e)});var m=F(e);p[e]&&(""==d&&0==m.now.length||m.now[0]==d)&&(m=m.now,m.splice(0,1),b&&b.apply(b,m))};h.end=function(b){var c;f.each(n,function(b,c){c.stateEndRegisterHandler&&c.stateEndRegisterHandler(a,d,h)});J[e+d]&&f.each(n,function(b,c){c.stateError&&c.stateError(a,d,h,"State end handler registered after state triggered")});c=Q();s.on(e+"state_"+d+"_end",function(){f.each(n,function(b,
e){e.stateEndCallHandler&&e.stateEndCallHandler(a,d,h,c)});var e=f.makeArray(arguments);e.splice(0,1);b&&b.apply(b,e)})};f.each(n,function(c,e){e.boundState&&e.boundState(a,b,d,h)})}),f(window).hashchange(Xa(a,e)),G[e]=F(e).now[0],Y[e]=K(e)):(jiant.logError("No hashchange plugin and states configured. Don't use states or add hashchange plugin (supplied with jiant)"),jiant.DEV_MODE&&alert("No hashchange plugin and states configured. Don't use states or add hashchange plugin (supplied with jiant)"))}
function Xa(a,b){return function(c,e,d){if(!d||d==b){location.hash.substring(1);c=F(b);var h=c.now[0],g=c.now;if(e||Y[b]!=K(b))g.splice(0,1),f.each(g,function(a,b){"undefined"==b&&(g[a]=void 0)}),void 0!=G[b]&&G[b]!=h&&(f.each(n,function(c,d){d.stateEndTrigger&&d.stateEndTrigger(a,G[b])}),s.trigger(b+"state_"+G[b]+"_end")),G[b]=h,Y[b]=K(b),h=h?h:"",f.each(n,function(b,c){c.stateStartTrigger&&c.stateStartTrigger(a,h,g)}),!J[b+h]&&(J[b+h]=1),s.trigger(b+"state_"+h+"_start",g)}}}function Wa(a,b,c,e){return function(){var d=
F(e),h=d.now;d.now=[a];f.each(arguments,function(b,c){void 0!=c?d.now.push(x(c)):h[0]!=a&&!va(e,h[0],a)||void 0==h[b+1]?d.now.push(x(c)):d.now.push(x(h[b+1]))});if(h&&(h[0]==a||va(e,h[0],a)))for(var g=arguments.length;g<h.length-1;)d.now.push(x(h[++g]));b?(d.root=[],f.each(d.now,function(a,b){d.root.push(b)})):f.each(d.root,function(a,b){d.root[a]=x(b)});wa(d,c,e)}}function va(a,b,c){a=p[a].states;return a[b]&&a[c]&&void 0!==a[b].statesGroup&&a[b].statesGroup===a[c].statesGroup}function wa(a,b,c){var e=
L(),d="",h=a.now+"|"+a.root;f.each(e,function(a,b){d=c==a?d+(a+"="+h+"="):d+(a+"="+b+"=")});e[c]||(d+=c+"="+h+"=");a=b||""==b?b:jiant.STATE_EXTERNAL_BASE;window.location.assign((a?a:"")+"#"+d);f(window).hashchange()}function L(){var a=location.hash.substring(1).split("="),b={};f.each(a,function(c,e){0==c%2&&e&&void 0!=a[c+1]&&(b[e]=a[c+1])});return b}function K(a){if(a)return a=L()[a],void 0===a?"":a;var b="";f.each(L(),function(a,e){b=e;return!1});return b}function F(a){a=K(a).split("|");var b={now:[],
root:[]};f.each(a,function(a,e){var d=e.split(",");f.each(d,function(d,e){b[0==a?"now":"root"].push(Z(e))})});b.now=b.now||[];b.root=b.root||[];return b}function x(a){if(f.isPlainObject(a)){var b="{";f.each(a,function(a,e){b+=x(a);b+=":";b+=x(e);b+="}"});b="}"==b[b.length-1]?b.substring(0,b.length-1):b;return x(b)}return(a+="")?a.replace(Ya,function(a){return xa[a]}):""}function Z(a){if((a=a?a.replace(Za,function(a){return ya[a]}):"")&&"{"==a[0]){var b={};a=a.substring(1,a.length).split("}");f.each(a,
function(a,e){var d=e.split(":");2==d.length&&(b[Z(d[0])]=Z(d[1]))});return b}return"undefined"===a?void 0:parseInt(a)+""==a?parseInt(a):a}function qa(a){a=a.toString();return a.slice(a.indexOf("(")+1,a.indexOf(")")).match(/([^\s,]+)/g)}function $a(a,b,c,e,d){f.each(b,function(h,g){var k=qa(g);k&&0<k.length?k.splice(k.length-1,1):k=[];b[h]=ab(a,c,e,h,k,f.isFunction(b[h])?b[h]():void 0,d);b[h]._jiantSpec=k;f.each(n,function(c,d){d.boundAjax&&d.boundAjax(a,b,h,b[h])})})}function aa(a,b,c){f.isArray(c)?
a[b]=c:f.isFunction(c)&&f.isFunction(c.on)?a[b]=c():f.isPlainObject(c)?f.each(c,function(b,d){c.jiant_innerData?d.jiant_accessor&&aa(a,b,d):aa(a,b,d)}):a[b]=c}function ab(a,b,c,e,d,h,g){return function(){var k={},m,r,l=arguments;f.isFunction(l[l.length-2])?(m=l[l.length-2],r=l[l.length-1]):f.isFunction(l[l.length-1])&&(m=l[l.length-1]);f.each(d,function(a,b){a<l.length&&!f.isFunction(l[a])&&void 0!=l[a]&&null!=l[a]&&aa(k,b,l[a])});k.antiCache3721||(k.antiCache3721=(new Date).getTime());var q=b||""==
b?b:jiant.AJAX_PREFIX,s=c||""==c?c:jiant.AJAX_SUFFIX,p=h?h:q+e+s,t=(new Date).getTime();f.each(n,function(b,c){c.ajaxCallStarted&&c.ajaxCallStarted(a,e,p,k)});q={data:k,traditional:!0,success:function(b){f.each(n,function(b,c){c.ajaxCallCompleted&&c.ajaxCallCompleted(a,e,p,k,(new Date).getTime()-t)});if(m){try{b=f.parseJSON(b)}catch(c){}f.each(n,function(c,d){d.ajaxCallResults&&d.ajaxCallResults(a,e,p,k,b)});m(b)}},error:function(b,c,d){r?r(b.responseText):jiant.handleErrorFn(b.responseText);f.each(n,
function(c,d){d.ajaxCallError&&d.ajaxCallError(a,e,p,k,(new Date).getTime()-t,b.responseText,b)})}};g&&(q.contentType="application/json",q.dataType="jsonp",q.xhrFields={withCredentials:!0},q.crossDomain=!0);f.ajax(p,q)}}function za(a,b){if(f.isArray(b)){var c=[];f.each(b,function(b,d){c.push(a.logic.intl.t(d))});return c.join(", ")}return a.logic.intl.t(b)}function Aa(a,b,c){if(a.logic.intl){var e=b[c];b[c]=function(c){if(void 0==c)return e.call(b);v[a.id]&&v[a.id].intl?e.call(b,za(a,c)):(e.call(b,
c),Ba(a,["intl"],function(){e.call(b,za(a,c))}))}}else P("nlabel used, but no intl declared, degrading nlabel to label")}function ja(a,b){Aa(a,b,"html");Aa(a,b,"text")}function bb(a,b,c){b&&(a.logic.intl?jiant.logError("Both logic.intl and app.intl declared, skipping app.intl"):a.logic.intl=b)}function Ta(a){a.url?(a.t=function(a){},a.t.spec=!0,a.t.empty=!0,f.getJSON(a.url,function(b){var c={};f.each(a,function(a,d){d.spec&&(c[a]=cb(a,d,b))});a.implement(c)})):P("Intl data url not provided, internationalization will not be loaded")}
function ba(a,b){if(b||""==b)return b;jiant.error("Not found translation for key: ",a);return a}function cb(a,b,c){return"t"==a?function(a){return ba(a,c[a])}:b.empty?b.params?function(b){return ba(a+b,c[a+b])}:function(){return ba(a,c[a])}:b}function A(a,b,c){if(a[b])return!0;if(a[c])return a[b]=a[c],!0;a[b]={};return!1}function Ca(a,b,c,e){jiant.DEV_MODE=c;!c&&0<=(window.location+"").toLowerCase().indexOf("jiant.dev_mode")&&(jiant.DEV_MODE=!0);H="";T=!0;var d=b.id?b.id:"no_app_id";b.id||jiant.logError("!!! Application id not specified. Not recommended since 0.20. Use 'id' property of application root to specify application id");
p[d]?jiant.logError("Application '"+d+"' already loaded, skipping multiple bind call"):(A(b,"logic","l"),A(b,"intl","i")&&bb(b,b.intl,d),A(b,"views","v")&&Na(b,b.views,a,e),A(b,"templates","t")&&Pa(b,b.templates,a,e),A(b,"ajax","a")&&$a(b,b.ajax,b.ajaxPrefix,b.ajaxSuffix,b.crossDomain),A(b,"events","e")&&Ua(b,b.events,d),A(b,"states","s")&&Va(b,b.states,b.stateExternalBase,d),A(b,"models","m")&&Ra(b,b.models,d),Sa(b,b.logic,d),jiant.DEV_MODE&&!T&&alert("Some elements not bound to HTML properly, check console"+
H),p[d]=b,v[d]||(v[d]={}),f.each(E,function(a,b){v[d][a]||(v[d][a]=E[a]);X(d,a);W(d,a)}),s.trigger(d+"onAppInit"+d),f.when.apply(f,Da).done(function(){s.trigger(d+"jiant_uiBound_"+d)}))}function db(a){return f.isPlainObject(a)?a.id:a}function Ba(a,b,c){c||b?c||(c=b,b=[]):(jiant.error("!!! Registering anonymous logic without application id. Not recommended since 0.20"),c=a,a=["no_app_id"]);f.isArray(a)||(a=[a]);1<a.length&&f.isArray(b)&&0<b.length?f.each(b,function(a,b){f.isArray(b)||jiant.error("Used multiple applications onUiBound and supplied wrong dependency list, use multi-array, like [[app1DepList], [app2DepList]]")}):
1==a.length&&b&&b.length?b=[b]:b||(b=[]);f.each(n,function(e,d){d.onUiBoundCalled&&d.onUiBoundCalled(a,b,c)});f.each(a,function(e,d){f.isPlainObject(d)&&(d=d.id,a[e]=d);!r[d]&&(r[d]={});!v[d]&&(v[d]={});b[e]&&f.each(b[e],function(a,b){!r[d][b]&&(r[d][b]=[]);!v[d][b]&&E[b]&&(X(d,b),ua(d,b));!v[d][b]&&r[d][b].push(c)})});ca(a,c)}function ca(a,b){var c=!0;f.each(a,function(d,e){if(!p[e])return s.one(e+"jiant_uiBound_"+e,function(){ca(a,b)}),c=!1});if(c){var e=!0,d=[f];f.each(a,function(c,g){f.each(r[g],
function(c,d){e=e&&0>f.inArray(b,d);!e&&s.one(g+"jiant_dependency_resolved_"+c,function(){ca(a,b)});return e});if(!e)return!1;d.push(p[g])});e&&b.apply(b,d)}}var ma={},ia={},T=!0,H,da,G={},Y={},v={},r={},E={},s=f({}),p={},Da=[],R=new Ea,J={},n=[],xa={";":";;",",":";1","=":";2","|":";3","{":";4","}":";5",":":";6","#":";7","'":";7"},ya={},Ya=/;|,|=|\||\{|\}|:|#/gi,Za=/;;|;1|;2|;3|;4|;5|;6|;7/gi;f.each(xa,function(a,b){ya[b]=a});return{AJAX_PREFIX:"",AJAX_SUFFIX:"",DEV_MODE:!0,PAGER_RADIUS:6,isMSIE:eval("/*@cc_on!@*/!1"),
STATE_EXTERNAL_BASE:void 0,getAwaitingDepends:function(){return r},bind:function(a,b){f.extend(a,b)},bindUi:function(a,b,c,e,d){f.isPlainObject(a)&&(d=e,e=c,c=b,b=a,a=b.appPrefix);f.each(n,function(a,c){c.bindStarted&&c.bindStarted(b)});var h=b.uiFactory?b.uiFactory:R;if(e){var g;d?(g=f("#"+d),g[0]||(g=f("<div id='"+d+"' style='display:none'></div>"),f("body").append(g))):g=f("body");g.load(e,{},function(){Ca(a,b,c,h)})}else Ca(a,b,c,h);f.each(n,function(a,c){c.bindCompleted&&c.bindCompleted(b)});
c&&setTimeout(function(){0<r.length&&C("Attention!! Some depends are not resolved",r)},1E4)},declare:ta,loadLibs:sa,goRoot:function(a){function b(a){var b=F(a);b.now=[];f.each(b.root,function(a,c){b.now.push(x(c));b.root[a]=x(c)});wa(b,void 0,a)}a&&b(a);!a&&f.each(L(),function(a,e){b(a)})},goState:function(a,b){},onUiBound:Ba,onAppInit:function(a,b){var c=new f.Deferred;Da.push(c.promise());var e=function(){c.resolve()};if(p[a])jiant.logError("Defining and calling onUiBound() before onAppInit().");
else s.on(a+"onAppInit"+a,function(){b&&b(f,p[a],e)})},refreshState:function(a){f(window).hashchange&&f(window).trigger("hashchange",[!0,db(a)])},getCurrentState:function(a){f.isPlainObject(a)&&(a=a.id);a=F(a);return a.now[0]?a.now[0]:""},setUiFactory:function(a){var b=!0;f.each(["template","viewComponent","view"],function(c,e){a[e]||(jiant.logError("UI Factory doesn't implement method "+e+", ignoring bad factory"),b=!1)});b&&(R=a)},visualize:function(a){sa(["https://raw.github.com/vecnas/jiant/master/graph.js"],
function(){a||f.each(p,function(b,c){a=b;return!1});jiant.onUiBound(a,["jiantVisualizer"],function(a,c){c.logic.jiantVisualizer.visualize(a,c)})},!0)},handleErrorFn:function(a){C(a)},logInfo:O,logError:C,info:ha,error:P,infop:function(){ea(O,arguments)},errorp:function(){ea(C,arguments)},parseTemplate:function(a,b){return f(B(a,b))},parseTemplate2Text:function(a,b){return B(a,b)},version:function(){return 148},formatDate:function(a){a=y(a);return null==a?"":t(a.getFullYear())+"-"+t(a.getMonth()+1)+
"-"+t(a.getDate())},formatDateUsa:function(a){a=y(a);return null==a?"":t(a.getMonth()+1)+"/"+t(a.getDate())+"/"+t(a.getFullYear())},formatMoney:function(a,b){b=void 0!==b?b:",";var c=parseInt(a);if(isNaN(c))return"";if(0==c)return"0";for(var e=""+Math.abs(c),d=e.length;0<d;d-=3)e=e.substring(0,d)+(d<e.length?b:"")+e.substring(d);return(0>c?"-":"")+e},formatTime:function(a){a=y(a);return null==a?"":t(a.getHours())+":"+t(a.getMinutes())},formatTimeSeconds:function(a){a=y(a);return null==a?"":t(a.getHours())+
":"+t(a.getMinutes())+":"+t(a.getSeconds())},randomIntBetween:function(a,b){return Math.floor(Math.random()*(b-a+1)+a)},getURLParameter:function(a){return decodeURI(((new RegExp(a+"=(.+?)(&|$)")).exec(location.search)||[,null])[1])},lfill:t,pick:function(a){var b=(new Date).getTime();da&&ha((a?a:"jiant.pick:")+" "+(b-da)+"ms");da=b},asObjArray:function(a,b,c){var e=[];f.each(a,function(a,f){var g={};g[b]=f;c&&(g[c]=a);e.push(g)});return e},addListener:function(a){n.push(a)},removeListener:function(a){n.remove(a)},
collection:{},container:{},containerPaged:ma,ctl:{},fn:function(a){},form:{},grid:{},image:{},input:{},inputDate:{},inputInt:{},inputFloat:{},label:{},nlabel:ia,meta:{},cssFlag:{},cssMarker:{},data:function(a){},lookup:function(a){},on:function(a){},pager:{},slider:{},stub:function(){var a="not available";arguments&&arguments.callee&&arguments.callee.caller&&(a=arguments.callee.caller.name);alert("stub called from function: "+a)},tabs:{},key:{left:37,up:38,right:39,down:40,del:46,backspace:8,tab:9,
end:35,home:36,enter:13,ctrl:17,escape:27,dot:190,dotExtra:110,comma:188,a:65,c:67,u:85,w:87,space:32,1:49,2:50,3:51,4:52,5:53,6:54}}}(jQuery);window.jiant&&window.jiant.version&&window.jiant.version()>=M.version()||(window.jiant=M)})();
